---
title: PytorchåŸºæœ¬æ“ä½œ
author: èµµæ—­å±±
tags: Pytorch
---

#### 1. PytorchåŸºæœ¬æ“ä½œæ¦‚è¦

æœç´¢ç½‘é¡µå­¦ä¹ Pytorchä¸­çœ‹åˆ°ä¸€å¼ ç»“æ„æ¸…æ™°çš„æ€ç»´å¯¼å›¾ï¼Œä½œè€…æ€»ç»“å¾—å¾ˆæ¸…æ™°ï¼Œå¼•ç”¨è¿‡æ¥å­¦ä¹ å­¦ä¹ ã€‚å¦‚ä¸‹ï¼š

Figure source: [https://zhuanlan.zhihu.com/p/36233589](https://zhuanlan.zhihu.com/p/36233589)

![](/assets/images/pytorchflowchart202002272158.jpg)

#### 2. Tensorå±æ€§

```python
x = torch.rand(5, 3)
x.dtype
x.device
x.layout
x.stride()
```

> torch.float32
>
> device(type='cpu')
>
> torch.strided
>
> (3, 1)

dtypeå°±æ˜¯æ•°æ®çš„ç±»å‹ï¼ŒPytorchå…±æœ‰å…«ç§æ•°æ®ç±»å‹ï¼š

| Data type                | dtype                         | dtype                |
| ------------------------ | ----------------------------- | -------------------- |
| 32-bit floating point    | torch.float32 or torch.float  | torch.*.FloatTensor  |
| 64-bit floating point    | torch.float64 or torch.double | torch.*.DoubleTensor |
| 16-bit floating point    | torch.float16 or torch.half   | torch.*.HalfTensor   |
| 8-bit integer (unsigned) | torch.uint8                   | torch.*.ByteTensor   |
| 8-bit integer (signed)   | torch.int8                    | torch.*.CharTensor   |
| 16-bit integer (signed)  | torch.int16 or torch.short    | torch.*.ShortTensor  |
| 32-bit integer (signed)  | torch.int32 or torch.int      | torch.*.IntTensor    |
| 64-bit integer (signed)  | torch.int64 or torch.long     | torch.*.LongTensor   |

layoutæ˜¯æ•°æ®åœ¨å†…å­˜ä¸­æ˜¯æ€ä¹ˆå­˜çš„ï¼Œåˆ†ä¸ºç¨€ç–å¼ é‡å’Œè‡´å¯†å¼ é‡ï¼Œå¸¸ç”¨çš„ä¸ºè‡´å¯†å¼ é‡ï¼ˆ`torch.strided`ï¼‰ã€‚

ç¬”è€…**æœ´ç´ çš„ç†è§£**å°±æ˜¯å®šä¹‰çš„å˜é‡åœ¨å†…å­˜ä¸­å’‹å­˜å‚¨çš„ï¼Œå¯¹äºŒç»´çŸ©é˜µè€Œè¨€ï¼Œç”¨äº†å¤šå°‘åˆ—ï¼Œè¡Œåˆ™è¢«å±•å¹³å­˜æˆä¸€è¡Œã€‚`x.t()`ç­‰åŒäºçŸ©é˜µè½¬ç½®ï¼Œæ²¡å­˜ï¼ŒåªæŠŠä¸¤ä¸ªæ•°æ®äº¤æ¢äº†ä¸€ä¸‹è¾“å‡ºã€‚

```python
In [7]: x.stride()                                              
Out[7]: (3, 1)

In [8]: x                                                       
Out[8]: 
tensor([[0.6031, 0.0937, 0.3282],
        [0.2758, 0.8520, 0.1412],
        [0.9676, 0.9618, 0.5699],
        [0.1657, 0.2150, 0.9051],
        [0.7828, 0.9131, 0.4832]])

In [9]: x.stride()                                              
Out[9]: (3, 1)

In [10]: x.t()                                                  
Out[10]: 
tensor([[0.6031, 0.2758, 0.9676, 0.1657, 0.7828],
        [0.0937, 0.8520, 0.9618, 0.2150, 0.9131],
        [0.3282, 0.1412, 0.5699, 0.9051, 0.4832]])

In [11]: x.t().stride()                                         
Out[11]: (1, 3)
```

å¯¹äºä¸‰ç»´å¼ é‡ï¼Œåä¸¤ç»´ç›¸ä¹˜æ˜¯ç¬¬ä¸€ä¸ªæ•°ï¼Œæœ€åä¸€ç»´æ˜¯ç¬¬äºŒä¸ªæ•°ï¼Œæœ€åä¸€ä¸ªæ•°ä¸º1ã€‚t()å‡½æ•°åªé€‚ç”¨äº2ç»´åŠä»¥ä¸‹çš„å¼ é‡ï¼Œä¸‰ç»´åŠä»¥ä¸Šä¸é€‚ç”¨ã€‚

```python
In [30]: x =torch.rand(3, 8, 5)                                 

In [31]: x.size()                                               
Out[31]: torch.Size([3, 8, 5])

In [32]: x.stride()                                             
Out[32]: (40, 5, 1)

In [33]: xx = torch.rand(6, 3, 7)                               

In [34]: xx.size()                                              
Out[34]: torch.Size([6, 3, 7])

In [35]: xx.stride()                                            
Out[35]: (21, 7, 1)
  
In [36]: xx.t()                                                 
----------------------------------------------------------------
RuntimeError                   Traceback (most recent call last)
<ipython-input-36-0b88b5bf88e4> in <module>
----> 1 xx.t()

RuntimeError: t() expects a tensor with <= 2 dimensions, but self is 3D

```

#### 3. åˆ›å»ºTensor

##### 3.1 ç›´æ¥åˆ›å»º

**torch.tensor()**

```python
In [2]: cell = torch.tensor([[6.50, 0, 0], [0, 6.50, 0], [0, 0, 
   ...: 6.50]])                                                 

In [3]: cell                                                    
Out[3]: 
tensor([[6.5000, 0.0000, 0.0000],
        [0.0000, 6.5000, 0.0000],
        [0.0000, 0.0000, 6.5000]])
```

##### 3.2 åˆ›å»ºç±»å‹ç›¸ä¼¼ä½†sizeä¸åŒçš„tensor

**.new()**ï¼š`inputs.new`&`torch.Tensor.new`

å‚è€ƒ: [https://www.jb51.net/article/180679.htm](https://www.jb51.net/article/180679.htm)

åˆ›å»ºä¸€ä¸ªæ–°çš„Tensorï¼Œè¯¥Tensorçš„**type**å’Œ**device**éƒ½å’ŒåŸæœ‰Tensorä¸€è‡´ï¼Œä¸”æ— å†…å®¹ã€‚

```python
In [2]: inputs = torch.rand(5, 3)                               

In [3]: inputs                                                  
Out[3]: 
tensor([[0.7991, 0.8743, 0.1387],
        [0.9594, 0.9258, 0.3077],
        [0.3318, 0.3850, 0.5850],
        [0.9942, 0.3455, 0.2891],
        [0.4658, 0.9288, 0.7334]])

In [4]: new_inputs1 = inputs.new()                               

In [5]: new_inputs1                                              
Out[5]: tensor([])

In [6]: new_inputs2 = torch.Tensor.new(inputs)                  

In [7]: new_inputs2                                             
Out[7]: tensor([])

In [8]: new_inputs3 = inputs.new(inputs.size())                 

In [9]: new_inputs3                                            
Out[9]: 
tensor([[0.0000e+00, 1.4013e-45, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 0.0000e+00, 0.0000e+00],
        [1.1704e-41, 0.0000e+00, 2.2369e+08],
        [0.0000e+00, 0.0000e+00, 0.0000e+00]])

In [10]: inputs.dtype, new_inputs1.dtype, new_inputs2.dtype, new_inputs3.dtype                                          
Out[10]: (torch.float32, torch.float32, torch.float32, torch.float32)

In [11]: inputs.device, new_inputs.device, new_inputs2.device, new_inputs3.device                                      
Out[11]: 
(device(type='cpu'), device(type='cpu'), device(type='cpu'), device(type='cpu'))
```

å®é™…åº”ç”¨ï¼š**æ·»åŠ å™ªå£°**

å¯ä»¥å¯¹Tensor**æ·»åŠ å™ªå£°**ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç å³å¯å®ç°ï¼š

```python
In [17]: noise = inputs.new(inputs.size()).normal_(0, 0.01)    

In [18]: noise                                                 
Out[18]: 
tensor([[-0.0021, -0.0025,  0.0182],
        [-0.0016,  0.0106, -0.0039],
        [ 0.0023,  0.0112,  0.0024],
        [ 0.0109,  0.0007,  0.0089],
        [ 0.0177,  0.0003, -0.0026]])
```

ç±»ä¼¼çš„æœ‰ï¼š`.new_ones`ã€`.new_zeros`ã€‚

##### 3.3 ä»numpyç”Ÿæˆ

**torch.from_numpy()**

å‚è€ƒï¼šhttps://www.jb51.net/article/144520.htm

```python
In [3]: np_data = np.arange(6).reshape((2, 3))                  

In [4]: np_data                                                 
Out[4]: 
array([[0, 1, 2],
       [3, 4, 5]])

# numpy è½¬ä¸º pytorchæ ¼å¼

In [5]: torch_data = torch.from_numpy(np_data)                  

In [6]: torch_data                                              
Out[6]: 
tensor([[0, 1, 2],
        [3, 4, 5]])

# torch è½¬ä¸ºnumpy

In [7]: tensor2array = torch_data.numpy()                       

In [8]: tensor2array                                            
Out[8]: 
array([[0, 1, 2],
       [3, 4, 5]])
```

çŸ©é˜µè½¬æ¢ä¸ºTensorï¼š

```python
# è½¬ä¸º32ä½æµ®ç‚¹æ•°ï¼Œtorchæ¥å—çš„éƒ½æ˜¯Tensorçš„å½¢å¼
In [1]: data = [[1, 2], [3, 4]]                                 

In [2]: data                                                    
Out[2]: [[1, 2], [3, 4]]

In [3]: tensor = torch.FloatTensor(data)                        

In [4]: tensor                                                  
Out[4]: 
tensor([[1., 2.],
        [3., 4.]])
```

##### 3.4 åˆ›å»ºç‰¹å®šTensor

###### 3.4.1 æ ¹æ®çŸ©é˜µè¦æ±‚

(1) **torch.eye()**

å‚è€ƒï¼šhttps://www.cnblogs.com/btschang/p/10300727.html

å¯¹è§’çº¿ä½ç½®å…¨1ï¼Œå…¶å®ƒä½ç½®å…¨ä¸º0çš„äºŒç»´çŸ©é˜µã€‚

```
In [7]: torch.eye(6)                                            
Out[7]: 
tensor([[1., 0., 0., 0., 0., 0.],
        [0., 1., 0., 0., 0., 0.],
        [0., 0., 1., 0., 0., 0.],
        [0., 0., 0., 1., 0., 0.],
        [0., 0., 0., 0., 1., 0.],
        [0., 0., 0., 0., 0., 1.]])
```

(2) **torch.empty()**

å‚è€ƒï¼šhttps://www.cnblogs.com/gato-chat/p/9064974.html

emptyæ–¹æ³•åˆ›å»ºçš„çŸ©é˜µä¸æ˜¯ç©ºçŸ©é˜µï¼Œè€Œæ˜¯æœªåˆå§‹åŒ–çš„çŸ©é˜µï¼Œæ‰€ä»¥é‡Œé¢çš„å€¼ä¸ä¸€å®šæ˜¯0ã€‚

```python
In [2]: x = torch.empty(5, 3)                                   

In [3]: x                                                       
Out[3]: 
tensor([[0.0000e+00, -0.0000e+00, 0.0000e+00],
        [-0.0000e+00, 1.8361e+25, 1.4603e-19],
        [1.6795e+08, 4.7423e+30, 4.7393e+30],
        [9.5461e-01, 4.4377e+27, 1.7975e+19],
        [4.6894e+27, 7.9463e+08, 3.2604e-12]])
```

(3) **torch.empty_like()**

`torch.empty_like(input)`è¿”å›å’Œinputçš„tensorä¸€æ ·sizeçš„emptyå¼ é‡ã€‚

```python
In [2]: x = torch.rand(5, 3)                                    

In [3]: x                                                       
Out[3]: 
tensor([[0.9643, 0.6685, 0.7706],
        [0.4562, 0.1438, 0.7719],
        [0.3813, 0.3628, 0.9026],
        [0.3653, 0.0948, 0.2917],
        [0.6953, 0.5089, 0.1560]])

In [4]: xx = torch.empty_like(x)                                

In [5]: xx                                                      
Out[5]: 
tensor([[0.0000e+00, 0.0000e+00, 0.0000e+00],
        [0.0000e+00, 1.8028e+28, 3.4740e-12],
        [1.4583e-19, 7.3470e+28, 6.1425e+28],
        [7.1441e+31, 6.9987e+22, 7.8675e+34],
        [4.7418e+30, 5.9663e-02, 7.0374e+22]])
```

###### 3.4.2 æ ¹æ®æ•°å€¼è¦æ±‚

(1) **torch.zeros()**

å‚è€ƒï¼šhttps://www.cnblogs.com/gato-chat/p/9064974.html

ç”Ÿæˆ0çŸ©é˜µï¼Œdetypeå‚æ•°æŒ‡å®šäº†ç”Ÿæˆçš„æ•°æ®çš„ç±»å‹ã€‚

```python
In [9]: x = torch.zeros(5, 3, dtype=torch.long)                 

In [10]: x                                                      
Out[10]: 
tensor([[0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0],
        [0, 0, 0]])
```

(2) **torch.zeros_like()**

`torch.zeros_like(input)`è¿”å›è·Ÿinputçš„tensorä¸€ä¸ªsizeçš„å…¨é›¶tensorã€‚

```python
In [6]: xx = torch.zeros_like(x)                                

In [7]: xx                                                      
Out[7]: 
tensor([[0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.]])
```

ä»¥ä¸‹çš„`*_like`æ–¹æ³•ä¸ä»¥ä¸Šç›¸åŒï¼Œä¸å†ä¸€ä¸€èµ˜è¿°ã€‚

(3) **torch.ones()**

è¿”å›å…¨1çŸ©é˜µã€‚

```python
In [2]: x = torch.ones(5, 3)                                    

In [3]: x                                                       
Out[3]: 
tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])
```

(4) **torch.full()**

`torch.full(size, fill_value)`ç”Ÿæˆä¸€ä¸ªç”¨fill_valueå¡«å……çš„ç‰¹å®šsizeå¼ é‡ã€‚

```python
In [6]: x = torch.full((5, 3), 2.71828)                         

In [7]: x                                                       
Out[7]: 
tensor([[2.7183, 2.7183, 2.7183],
        [2.7183, 2.7183, 2.7183],
        [2.7183, 2.7183, 2.7183],
        [2.7183, 2.7183, 2.7183],
        [2.7183, 2.7183, 2.7183]])
```

(5) **torch.arange()** & **torch.range()**

å‚è€ƒï¼šhttps://blog.csdn.net/m0_37586991/article/details/88830026

```python
In [2]: x = torch.range(1, 6)                                   
/usr/local/Caskroom/miniconda/base/bin/ipython:1: UserWarning: torch.range is deprecated in favor of torch.arange and will be removed in 0.5. Note that arange generates values in [start; end), not [start; end].
  #!/usr/local/Caskroom/miniconda/base/bin/python

In [3]: x                                                       
Out[3]: tensor([1., 2., 3., 4., 5., 6.])

In [4]: y = torch.arange(1, 6)                                  

In [5]: y                                                       
Out[5]: tensor([1, 2, 3, 4, 5])

In [6]: x.dtype, y.dtype                                        
Out[6]: (torch.float32, torch.int64)
```

*  `torch.range(start=1, end=6)`çš„ç»“æœæ˜¯ä¼šåŒ…å«`end`çš„ï¼Œè€Œ`torch.arange(start=1, end=6)`çš„ç»“æœå¹¶ä¸åŒ…æ‹¬`end`ï¼›

* ä¸¤è€…åˆ›å»ºçš„`tensor`çš„ç±»å‹ä¹Ÿä¸ä¸€æ ·ã€‚

(6) **torch.linspace()**

å‚è€ƒï¼šhttps://blog.csdn.net/york1996/article/details/81671128

`torch.linspace(start, end, steps)`è¿”å›ä¸€ä¸ªä¸€ç»´çš„tensorï¼Œè¿™ä¸ªå¼ é‡åŒ…å«äº†ä»startåˆ°endï¼Œåˆ†æˆstepsä¸ªæ®µå¾—åˆ°çš„å‘é‡ã€‚è¾“å‡ºå¼ é‡çš„é•¿åº¦ç”±stepså†³å®šã€‚

```python
In [2]: torch.linspace(3, 10, 5)                                
Out[2]: tensor([ 3.0000,  4.7500,  6.5000,  8.2500, 10.0000])

In [3]: torch.linspace(-10, 10, steps=6)                        
Out[3]: tensor([-10.,  -6.,  -2.,   2.,   6.,  10.])
```

(7) **torch.logspace()**

`torch.logspace(start, end, steps)`è¿”å›ä¸€ä¸ªä¸€ç»´çš„tensorï¼Œè¿™ä¸ªå¼ é‡åŒ…å«äº†ä»<img src="http://latex.codecogs.com/gif.latex?\10^{start}" />  åˆ°<img src="http://latex.codecogs.com/gif.latex?\10^{end}" />ï¼Œåˆ†æˆstepsä¸ªæ®µå¾—åˆ°çš„å‘é‡ã€‚è¾“å‡ºå¼ é‡çš„é•¿åº¦ç”±stepså†³å®šã€‚

```python
In [4]: torch.logspace(1, 5, 4)                                 
Out[4]: tensor([1.0000e+01, 2.1544e+02, 4.6416e+03, 1.0000e+05])

In [5]: torch.logspace(1, 5, 5)                                 
Out[5]: tensor([1.0000e+01, 1.0000e+02, 1.0000e+03, 1.0000e+04, 1.0000e+05])
```

##### 3.5 éšæœºé‡‡æ ·ç”Ÿæˆ

(1) **torch.normal()**

å‚è€ƒï¼š[https://blog.csdn.net/sxs11/article/details/81775715](https://blog.csdn.net/sxs11/article/details/81775715)

`torch.normal(mean, std)`è¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«ä»ç»™å®šå‚æ•°meansã€stdçš„ç¦»æ•£æ­£æ€åˆ†å¸ƒä¸­æŠ½å–éšæœºæ•°ã€‚

> mean â€” å‡å€¼
>
> std â€” æ ‡å‡†å·®

```python
In [11]: torch.normal(means=torch.arange(1, 11), std=torch.arange(1, 0, -0.1))                                                    
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-11-4540d51055de> in <module>
----> 1 torch.normal(means=torch.arange(1, 11), std=torch.arange(1, 0, -0.1))

TypeError: normal() received an invalid combination of arguments - got (std=Tensor, means=Tensor, ), but expected one of:
 * (Tensor mean, Tensor std, torch.Generator generator, Tensor out)
 * (Tensor mean, float std, torch.Generator generator, Tensor out)
 * (float mean, Tensor std, torch.Generator generator, Tensor out)
 * (float mean, float std, tuple of ints size, torch.Generator generator, Tensor out, torch.dtype dtype, torch.layout layout, torch.device device, bool pin_memory, bool requires_grad)


In [12]: torch.normal(mean=torch.arange(1, 11), std=torch.arange(1, 0, -0.1))                                                     
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-12-a4a4388458ef> in <module>
----> 1 torch.normal(mean=torch.arange(1, 11), std=torch.arange(1, 0, -0.1))

RuntimeError: "norma_cpu" not implemented for 'Long'

In [13]: torch.normal(mean=torch.arange(1., 11.), std=torch.arange(1, 0, -0.1))                                                   
Out[13]: 
tensor([ 1.8979,  1.5922,  3.0055,  3.7566,  4.8068,  6.4627,  7.1539,  7.4512,
         9.1401, 10.0355])
```

ç®€å•åˆ†æ`In [11]`ã€`In [12]`ä¸¤ç§é”™è¯¯ï¼š

**In [11]**: [å‚è€ƒç½‘é¡µ](https://blog.csdn.net/sxs11/article/details/81775715)ä¸­è¾“å…¥å‚æ•°`means=...`ä¸å·¥ä½œï¼Œæ”¹æˆ`mean=...`å°±å¯ä»¥äº†ï¼Œå¦å¤–æ­¤å¤„ç»™å‡ºäº†`normal`å‡½æ•°çš„å‡ ç§è¾“å…¥ç»„åˆï¼š

>  * (Tensor mean, Tensor std, torch.Generator generator, Tensor out)
>  * (Tensor mean, float std, torch.Generator generator, Tensor out)
>  * (float mean, Tensor std, torch.Generator generator, Tensor out)
>  * (float mean, float std, tuple of ints size, torch.Generator generator, Tensor out, torch.dtype dtype, torch.layout layout, torch.device device, bool pin_memory, bool requires_grad)

**In [12]**: æ ¹æ®ä¸Šè¿°è¾“å…¥ç»„åˆï¼Œ`std`å’Œ`mean`åªæ¥å—`float`å’Œ`Tensor`ä¸¤ç§dtypeï¼Œæ‰€ä»¥`In [12]`ä¸­`mean=torch.arange(1, 11)`ä¸å·¥ä½œï¼Œæ”¹æˆ`mean=torch.arange(1., 11.)`å³å¯ã€‚

å…¶ä¸­ï¼š

```python
In [13]: torch.normal(mean=torch.arange(1., 11.), std=torch.arange(1, 0, -0.1))                                                   
Out[13]: 
tensor([ 1.8979,  1.5922,  3.0055,  3.7566,  4.8068,  6.4627,  7.1539,  7.4512,
         9.1401, 10.0355])
```

æ ¹æ®`mean`å’Œ`std`ç”Ÿæˆçš„å¼ é‡å«ä¹‰å¦‚ä¸‹ï¼š

```python
 1.8979 #æ˜¯ä»å‡å€¼ä¸º1ï¼Œæ ‡å‡†å·®ä¸º1çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 1.5922 #æ˜¯ä»å‡å€¼ä¸º2ï¼Œæ ‡å‡†å·®ä¸º0.9çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 3.0055 #æ˜¯ä»å‡å€¼ä¸º3ï¼Œæ ‡å‡†å·®ä¸º0.8çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 3.7566 #æ˜¯ä»å‡å€¼ä¸º4ï¼Œæ ‡å‡†å·®ä¸º0.7çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 4.8068 #æ˜¯ä»å‡å€¼ä¸º5ï¼Œæ ‡å‡†å·®ä¸º0.6çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 6.4627 #æ˜¯ä»å‡å€¼ä¸º6ï¼Œæ ‡å‡†å·®ä¸º0.5çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 7.1539 #æ˜¯ä»å‡å€¼ä¸º7ï¼Œæ ‡å‡†å·®ä¸º0.4çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 7.4512 #æ˜¯ä»å‡å€¼ä¸º8ï¼Œæ ‡å‡†å·®ä¸º0.3çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
 9.1401 #æ˜¯ä»å‡å€¼ä¸º9ï¼Œæ ‡å‡†å·®ä¸º0.2çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
10.0355 #æ˜¯ä»å‡å€¼ä¸º10ï¼Œæ ‡å‡†å·®ä¸º0.1çš„æ­£æ€åˆ†å¸ƒä¸­éšæœºç”Ÿæˆçš„
```

<u>6.4627ï¼ˆå‡å€¼ä¸º6ï¼Œæ ‡å‡†å·®ä¸º0.5ï¼‰å’Œ7.4512ï¼ˆæ˜¯ä»å‡å€¼ä¸º8ï¼Œæ ‡å‡†å·®ä¸º0.3ï¼‰</u>ä¸¤ä¸ªå€¼æœ‰æ‰€åå·®ã€‚

(2) **torch.rand()** & **torch.randn()**

torch.randn()å’Œtorch.rand()æœ‰ä»€ä¹ˆåŒºåˆ«

å‚è€ƒï¼š[https://blog.csdn.net/wangwangstone/article/details/89815661](https://blog.csdn.net/wangwangstone/article/details/89815661)

torch.randå’Œtorch.randnæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ y = torch.rand(5,3) y=torch.randn(5,3)

ä¸€ä¸ªå‡åŒ€åˆ†å¸ƒï¼Œä¸€ä¸ªæ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚

***å‡åŒ€åˆ†å¸ƒ***

`torch.rand(*size)`è¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«äº†ä»åŒºé—´[0,1)çš„å‡åŒ€åˆ†å¸ƒä¸­æŠ½å–çš„ä¸€ç»„éšæœºæ•°ã€‚å¼ é‡çš„å½¢çŠ¶ç”±å‚æ•°sizeå®šä¹‰ã€‚

```python
In [21]: torch.rand(size=(3, 2))                                 
Out[21]: 
tensor([[0.2218, 0.1115],
        [0.7232, 0.4805],
        [0.7677, 0.1653]])

In [22]: torch.rand(5, 3)                                       
Out[22]: 
tensor([[0.4548, 0.8788, 0.6698],
        [0.6992, 0.2677, 0.1843],
        [0.8135, 0.6389, 0.9419],
        [0.8074, 0.5690, 0.4269],
        [0.7801, 0.3185, 0.3531]])
```

***æ ‡å‡†æ­£æ€åˆ†å¸ƒ***

`torch.randn(*size)`è¿”å›ä¸€ä¸ªå¼ é‡ï¼ŒåŒ…å«äº†ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼ˆå‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1ï¼Œå³é«˜æ–¯ç™½å™ªå£°ï¼‰ã€‚

```python
In [23]: torch.randn(size=(4, 2))                               
Out[23]: 
tensor([[-2.5096,  0.3663],
        [ 0.8938,  0.3082],
        [ 0.0469,  0.3610],
        [-0.6472, -0.0929]])

In [24]: torch.randn(4, 2)                                      
Out[24]: 
tensor([[ 0.1326,  1.4875],
        [-0.3001,  0.0889],
        [ 0.5647,  0.5865],
        [ 0.6648,  0.7136]])
```

>`å…¶ä»–`ï¼š
>
>***ç¦»æ•£æ­£æ€åˆ†å¸ƒ***
>
>`torch.normal(mean, std)`ï¼Œç”¨æ³•è§å‰è¿°ã€‚
>
>***çº¿æ€§é—´è·å‘é‡***
>
>`torch.linspace(start, end, steps=100)`ï¼Œç”¨æ³•è§å‰è¿°ã€‚

(3) **torch.randint()**

`torch.randint(low, high, size)`è¿”å›`low`ï½`high`ä¹‹é—´æ•´æ•°ç‰¹å®š`size`çš„å¼ é‡ã€‚

```python
In [18]: idx = torch.randint(low=0, high=20, size=(10, 10))     

In [19]: idx                                                    
Out[19]: 
tensor([[ 6, 17, 14, 14, 14,  9,  6,  2,  2,  5],
        [19, 18, 13,  8, 14,  8,  1,  8, 17, 14],
        [ 9,  3,  1, 19,  2,  6,  1, 16,  8,  6],
        [18, 12,  0, 12,  6,  3, 14,  6, 17, 12],
        [10,  3,  9, 16,  7,  4,  5,  2, 19, 14],
        [ 3,  0, 13, 11,  0, 16,  3, 12,  7, 12],
        [ 1, 15, 15,  3, 15,  5, 13,  8,  7,  3],
        [ 8,  2, 11, 11, 13, 14,  5, 13,  0, 17],
        [ 0, 10, 15,  4, 12, 17, 19,  7, 13,  1],
        [16, 15, 12,  7, 15, 11,  8, 16, 11,  4]])

In [20]: idx.dtype                                              
Out[20]: torch.int64
```

`low`å’Œ`high`å¿…é¡»ä¹Ÿæ˜¯æ•´æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

```python
In [21]: idx = torch.randint(low=0.5, high=20.1, size=(10, 10)) 
----------------------------------------------------------------
TypeError                      Traceback (most recent call last)
<ipython-input-21-94e2fb84d2eb> in <module>
----> 1 idx = torch.randint(low=0.5, high=20.1, size=(10, 10))

TypeError: randint() received an invalid combination of arguments - got (size=tuple, high=float, low=float, ), but expected one of:
 * (int high, tuple of ints size, torch.Generator generator, Tensor out, torch.dtype dtype, torch.layout layout, torch.device device, bool requires_grad)
 * (int low, int high, tuple of ints size, torch.Generator generator, Tensor out, torch.dtype dtype, torch.layout layout, torch.device device, bool requires_grad)
```

(4) **torch.randperm()**

å‚è€ƒï¼šhttps://www.cnblogs.com/ymjyqsx/p/6200692.html

`torch.randperm(n)`åŠŸèƒ½æ˜¯æŠŠ1åˆ°nè¿™äº›æ•°éšæœºæ‰“ä¹±å¾—åˆ°ä¸€ä¸ªæ•°å­—åºåˆ—ã€‚

```python
In [22]: xrp = torch.randperm(10)                               

In [23]: xrp                                                    
Out[23]: tensor([4, 9, 2, 7, 1, 5, 6, 0, 3, 8])

In [24]: xrp.dtype                                              
Out[24]: torch.int64
```

#### 4. æ“ä½œTensor

##### 4.1 åŸºæœ¬æ“ä½œ

###### 4.1.1 indexing

(1) **torch.index_select()**

å‚è€ƒï¼š[https://www.jb51.net/article/174524.htm](https://www.jb51.net/article/174524.htm)

`index_select(input, dim, index)`è¡¨ç¤º**ä»å¼ é‡çš„æŸä¸ªç»´åº¦çš„æŒ‡å®šä½ç½®é€‰å–æ•°æ®**ã€‚

`input`ä¸ºè¾“å…¥çš„tensorï¼Œå³ç´¢å¼•çš„å¯¹è±¡ï¼›`dim`è¡¨ç¤ºä»ç¬¬å‡ ç»´æŒ‘é€‰æ•°æ®ï¼Œ0è¡¨ç¤ºæŒ‰è¡Œç´¢å¼•ï¼Œ1è¡¨ç¤ºæŒ‰åˆ—ç´¢å¼•ï¼›`index`è¡¨ç¤ºä»ç¬¬`dim`ä¸ªå‚æ•°ç»´åº¦ä¸­çš„å“ªä¸ªä½ç½®æŒ‘é€‰æ•°æ®ã€‚

```python
In [2]: x = torch.randint(0, 99, size=(10, 10))                 

In [3]: x                                                       
Out[3]: 
tensor([[45, 81, 16, 56, 95, 91, 37, 34, 81, 98],
        [94, 87,  7, 71, 53, 43, 86, 15, 62, 71],
        [57, 30, 78, 50, 68, 19, 12, 52,  0, 72],
        [84, 27, 44, 26, 79, 72, 32, 15, 73, 98],
        [14, 21, 40, 65, 76, 88, 89,  6, 71, 18],
        [67,  9, 27,  3, 50, 72, 56, 68, 18, 87],
        [37,  7,  5, 60,  6, 12, 17, 24, 83, 23],
        [32, 55, 79, 83, 55, 26, 44, 62, 22, 25],
        [ 3, 16, 47, 45, 18, 47, 46, 19, 16,  4],
        [50, 92, 86, 11, 90, 53,  1, 92, 22, 92]])

In [4]: torch.index_select(x, 0, 2)                             
----------------------------------------------------------------
TypeError                      Traceback (most recent call last)
<ipython-input-4-a9bfb26e8f43> in <module>
----> 1 torch.index_select(x, 0, 2)

TypeError: index_select() received an invalid combination of arguments - got (Tensor, int, int), but expected one of:
 * (Tensor input, name dim, Tensor index, Tensor out)
 * (Tensor input, int dim, Tensor index, Tensor out)

In [5]: torch.index_select(x, 0, torch.tensor([0, 2]))          
Out[5]: 
tensor([[45, 81, 16, 56, 95, 91, 37, 34, 81, 98],
        [57, 30, 78, 50, 68, 19, 12, 52,  0, 72]])

In [6]: torch.index_select(x, 0, torch.tensor([8]))                                                                               
Out[6]: tensor([[ 3, 16, 47, 45, 18, 47, 46, 19, 16,  4]])
  
In [7]: torch.index_select(x, 1, torch.tensor([0, 6]))                                                                           
Out[7]: 
tensor([[45, 37],
        [94, 86],
        [57, 12],
        [84, 32],
        [14, 89],
        [67, 56],
        [37, 17],
        [32, 44],
        [ 3, 46],
        [50,  1]])
```

ä»`In [4]`æŠ¥é”™ä¿¡æ¯å¯çŸ¥ï¼Œindexä¹Ÿé¡»æ˜¯ä¸€ä¸ªTensorï¼š

>  * (Tensor input, name dim, Tensor index, Tensor out)
>  * (Tensor input, int dim, Tensor index, Tensor out)

dim = 0æ—¶ï¼Œtorch.tensor([0, 2])è¡¨ç¤ºç¬¬0è¡Œå’Œç¬¬2è¡Œï¼Œtorch.tensor([8])è¡¨ç¤ºç¬¬8è¡Œï¼›

dim = 1æ—¶ï¼Œtorch.tensor([0, 6])è¡¨ç¤ºç¬¬0è¡Œå’Œç¬¬6è¡Œã€‚

(2) **torch.masked_select()**

å‚è€ƒï¼š[https://blog.csdn.net/q511951451/article/details/81611903](https://blog.csdn.net/q511951451/article/details/81611903)ï¼›[https://blog.csdn.net/SoftPoeter/article/details/81667810](https://blog.csdn.net/SoftPoeter/article/details/81667810)

`torch.masked_select(input, mask)`å°†æ ¹æ®å¼ é‡maskä¸­çš„äºŒå…ƒå€¼ï¼Œå–è¾“å…¥å¼ é‡ğŸ€„ï¸çš„æŒ‡å®šé¡¹ï¼ˆmaskä¸ºä¸€ä¸ªByte Tensorï¼‰ï¼Œå°†å–å€¼è¿”å›åˆ°ä¸€ä¸ªæ–°çš„1Då¼ é‡ï¼Œ**å¼ é‡maské¡»è·Ÿinputå¼ é‡æœ‰ç›¸åŒæ•°é‡çš„å…ƒç´ æ•°ç›®ï¼Œä½†å½¢çŠ¶æˆ–ç»´åº¦ä¸éœ€è¦ç›¸åŒ**ã€‚è¿”å›çš„å¼ é‡ä¸ä¸åŸå§‹å¼ é‡å…±äº«å†…å­˜ç©ºé—´ã€‚

`input`(Tensor)ä¸ºè¾“å…¥å¼ é‡ï¼Œ`mask`(Byte Tensor)ä¸ºæ©ç å¼ é‡ï¼ŒåŒ…å«äº†äºŒå…ƒç´¢å¼•å€¼ã€‚

```python
In [2]: x = torch.randn(5, 3)                                   

In [3]: x                                                       
Out[3]: 
tensor([[ 0.2893, -0.1957, -0.9152],
        [ 0.6943,  0.5319,  0.8884],
        [-0.8882,  0.5574,  0.7390],
        [ 1.4411,  0.3321, -0.9831],
        [ 0.9207,  0.8473, -0.4209]])

In [4]: mask = x.ge(0.5)                                        

In [5]: mask                                                    
Out[5]: 
tensor([[False, False, False],
        [ True,  True,  True],
        [False,  True,  True],
        [ True, False, False],
        [ True,  True, False]])

In [6]: torch.masked_select(x, mask)                            
Out[6]: tensor([0.6943, 0.5319, 0.8884, 0.5574, 0.7390, 1.4411, 0.9207, 0.8473])
```

###### 4.1.2 joining

(1) **torch.cat()**

å‚è€ƒï¼šhttps://www.cnblogs.com/JeasonIsCoding/p/10162356.html

`torch.cat((tensor_A, tensor_B), dim)`è¡¨ç¤ºæŠŠå¼ é‡Aã€Bæ‹¼æ¥åœ¨ä¸€èµ·ã€‚

***åŸºæœ¬ç”¨æ³•***ï¼šæ‹¼æ¥ä¸¤ä¸ªTensor

dimä¸º0æ—¶è¡¨ç¤ºæŒ‰è¡Œæ‹¼æ¥ï¼š

```python
In [2]: A = torch.ones(4, 3)                                    

In [3]: A                                                       
Out[3]: 
tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])

In [4]: B = torch.zeros(2, 3)                                   

In [5]: B                                                       
Out[5]: 
tensor([[0., 0., 0.],
        [0., 0., 0.]])

In [6]: C = torch.cat((A, B), 0) # Aï¼ŒBé¡»åˆ—æ•°ç›¸åŒ                               

In [7]: C                                                       
Out[7]: 
tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [0., 0., 0.],
        [0., 0., 0.]])
```

dimä¸º1æ—¶è¡¨ç¤ºæŒ‰åˆ—æ‹¼æ¥ï¼š

```python
In [2]: A = torch.ones(4, 3)                                    

In [3]: A                                                       
Out[3]: 
tensor([[1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.],
        [1., 1., 1.]])

In [8]: AA = torch.ones(4, 2) * 2                               

In [9]: AA                                                      
Out[9]: 
tensor([[2., 2.],
        [2., 2.],
        [2., 2.],
        [2., 2.]])

In [10]: CC = torch.cat((A, AA), 1) #Aï¼ŒAAé¡»è¡Œæ•°ç›¸åŒ                            

In [11]: CC                                                     
Out[11]: 
tensor([[1., 1., 1., 2., 2.],
        [1., 1., 1., 2., 2.],
        [1., 1., 1., 2., 2.],
        [1., 1., 1., 2., 2.]])
```

***å…¶ä»–ç”¨æ³•***ï¼šæ‹¼æ¥ä¸¤ä¸ªlist

```python
In [2]: x = torch.Tensor([[1], [2], [3]])                       

In [3]: x                                                       
Out[3]: 
tensor([[1.],
        [2.],
        [3.]])

In [4]: x1 = [x*2 for i in range(1, 4)]                         

In [5]: x1                                                      
Out[5]: 
[tensor([[2.],
         [4.],
         [6.]]),
 tensor([[2.],
         [4.],
         [6.]]),
 tensor([[2.],
         [4.],
         [6.]])]

In [6]: xx1 = torch.cat((x1), 1)                                

In [7]: xx1                                                     
Out[7]: 
tensor([[2., 2., 2.],
        [4., 4., 4.],
        [6., 6., 6.]])

In [8]: xx1_1 = torch.cat(x1, 0)                               

In [9]: xx1_1                                                  
Out[9]: 
tensor([[2.],
        [4.],
        [6.],
        [2.],
        [4.],
        [6.],
        [2.],
        [4.],
        [6.]])
```

(2) **torch.stack()**

å‚è€ƒï¼š[https://www.cnblogs.com/yifdu25/p/9399047.html](https://www.cnblogs.com/yifdu25/p/9399047.html)ï¼›[https://blog.csdn.net/Teeyohuang/article/details/80362756](https://blog.csdn.net/Teeyohuang/article/details/80362756)

`torch.stack()`ä¸`torch.cat()`çš„åŒºåˆ«åœ¨äºï¼š

- `cat`å¯¹æ•°æ®æ²¿æŸä¸€ç»´åº¦è¿›è¡Œæ‹¼æ¥ï¼Œ`cat`åæ•°æ®çš„æ€»ç»´åº¦æ•°ä¸å˜ï¼›
- `stack`ä¸ºå¢åŠ æ–°çš„ç»´åº¦è¿›è¡Œå †å ã€‚

å¦‚å¯¹ä¸¤ä¸ª1*2ç»´çš„tensoråœ¨ç¬¬0ä¸ªç»´åº¦ä¸Š`stack`ï¼Œåˆ™ä¼šå˜æˆ2\*2\*2çš„tensorï¼›åœ¨ç¬¬1ä¸ªç»´åº¦ä¸Š`stack`ï¼Œåˆ™ä¼šå˜æˆ1\*2\*2çš„tensorã€‚

```python
In [2]: a = torch.rand(1, 2)                                    

In [3]: a                                                       
Out[3]: tensor([[0.5289, 0.9828]])

In [4]: b = torch.rand((1, 2))                                  

In [5]: b                                                       
Out[5]: tensor([[0.1610, 0.5676]])

In [6]: c = torch.stack((a, b), 0)                              

In [7]: c                                                       
Out[7]: 
tensor([[[0.5289, 0.9828]],

        [[0.1610, 0.5676]]])
```

å¯¹äºé«˜ç»´åº¦å¼ é‡ï¼š

```python
In [2]: a = torch.randn((1, 2, 3, 4))                           

In [3]: a                                                       
Out[3]: 
tensor([[[[ 0.3603, -0.4322, -0.3183, -0.9004],
          [-0.5849,  1.2128, -1.0935,  0.4143],
          [ 1.4446,  1.3867,  1.8066, -2.2650]],

         [[ 2.2352, -1.2699, -0.5572, -1.8167],
          [-0.5426, -0.1514,  0.1314, -1.2296],
          [ 0.0166,  0.6789, -0.6616, -0.6927]]]])

In [4]: b = torch.stack((a, a), 0)                              

In [5]: b                                                       
Out[5]: 
tensor([[[[[ 0.3603, -0.4322, -0.3183, -0.9004],
           [-0.5849,  1.2128, -1.0935,  0.4143],
           [ 1.4446,  1.3867,  1.8066, -2.2650]],

          [[ 2.2352, -1.2699, -0.5572, -1.8167],
           [-0.5426, -0.1514,  0.1314, -1.2296],
           [ 0.0166,  0.6789, -0.6616, -0.6927]]]],



        [[[[ 0.3603, -0.4322, -0.3183, -0.9004],
           [-0.5849,  1.2128, -1.0935,  0.4143],
           [ 1.4446,  1.3867,  1.8066, -2.2650]],

          [[ 2.2352, -1.2699, -0.5572, -1.8167],
           [-0.5426, -0.1514,  0.1314, -1.2296],
           [ 0.0166,  0.6789, -0.6616, -0.6927]]]]])

In [6]: a.shape, b.shape                                        
Out[6]: (torch.Size([1, 2, 3, 4]), torch.Size([2, 1, 2, 3, 4]))

In [7]: c = torch.stack((a, a), 1)                              

In [8]: c                                                       
Out[8]: 
tensor([[[[[ 0.3603, -0.4322, -0.3183, -0.9004],
           [-0.5849,  1.2128, -1.0935,  0.4143],
           [ 1.4446,  1.3867,  1.8066, -2.2650]],

          [[ 2.2352, -1.2699, -0.5572, -1.8167],
           [-0.5426, -0.1514,  0.1314, -1.2296],
           [ 0.0166,  0.6789, -0.6616, -0.6927]]],


         [[[ 0.3603, -0.4322, -0.3183, -0.9004],
           [-0.5849,  1.2128, -1.0935,  0.4143],
           [ 1.4446,  1.3867,  1.8066, -2.2650]],

          [[ 2.2352, -1.2699, -0.5572, -1.8167],
           [-0.5426, -0.1514,  0.1314, -1.2296],
           [ 0.0166,  0.6789, -0.6616, -0.6927]]]]])

In [9]: a.shape, c.shape                                        
Out[9]: (torch.Size([1, 2, 3, 4]), torch.Size([1, 2, 2, 3, 4]))

In [10]: d = torch.stack((a, a), 3)                             

In [11]: a.shape, d.shape                                       
Out[11]: (torch.Size([1, 2, 3, 4]), torch.Size([1, 2, 3, 2, 4]))
```

æ ¹æ®é«˜ç»´åº¦å¼ é‡çš„`stack`å¯çŸ¥ï¼Œdim=0å³åœ¨ç¬¬0ä¸ªç»´åº¦å‰å¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œdim=1å³åœ¨ç¬¬1ä¸ªç»´åº¦ä¹‹å‰å¢åŠ ä¸€ä¸ªç»´åº¦ï¼Œ...ï¼Œä¾æ­¤ç±»æ¨ã€‚

(3) **torch.gather()**

å‚è€ƒï¼š[https://blog.csdn.net/edogawachia/article/details/80515038](https://blog.csdn.net/edogawachia/article/details/80515038)ï¼›https://blog.csdn.net/Lucky_Rocks/article/details/79676095ã€‚

`torch.gather(input, dim, index)`è¡¨ç¤ºæ²¿ç»™å®šçš„dimï¼Œå°†è¾“å…¥ç´¢å¼•å¼ é‡indexæŒ‡å®šä½ç½®çš„å€¼è¿›è¡Œèšåˆã€‚

```python
In [18]: t = torch.Tensor([[1,2,3],[4,5,6]])                    

In [19]: t                                                      
Out[19]: 
tensor([[1., 2., 3.],
        [4., 5., 6.]])

In [20]: torch.gather(t, 1, torch.LongTensor([[1,0],[0,0]]))    
Out[20]: 
tensor([[2., 1.],
        [4., 4.]])
```

æ ¹æ®ä»¥ä¸Šç¤ºä¾‹ä»£ç ç†è§£æ­¤å‡½æ•°ï¼š

* `dim=1`æŒ‰åˆ—å–ï¼›
* ç¬¬ä¸€ç»„indexä¸º[1, 0]ï¼Œç¬¬1åˆ—ï¼ˆå®é™…çš„ç¬¬äºŒåˆ—ï¼‰ä¸º2ï¼Œç¬¬0åˆ—ä¸º1ï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œä¸º[2, 1]ï¼›
* åŒç†ï¼Œç¬¬äºŒç»„indexä¸º[0, 0]ï¼Œç¬¬0åˆ—ä¸º4ï¼Œç¬¬0åˆ—ä¸º4ï¼Œæ‰€ä»¥ç¬¬äºŒè¡Œä¸º[4, 4]ã€‚
* æ‰€ä»¥ï¼Œæœ€ç»ˆç»“æœä¸º`[[2., 1.], [4., 4.]]`ã€‚

###### 4.1.3 slicing

(1) **torch.split()**

`torch.split(tensor, split_size, dim=0)`å°†è¾“å…¥å¼ é‡åˆ†å‰²ä¸ºç›¸ç­‰å½¢çŠ¶çš„å—ã€‚

`split_size`è¡¨ç¤ºéœ€è¦åˆ‡åˆ†çš„å¤§å°ï¼Œå¯ä»¥ä¸º**`int`**å’Œ**`list`**ä¸¤ç§ç±»å‹ã€‚

***å½“`split_size`ä¸º`int`æ•´æ•°æ—¶***ï¼š

å¦‚æœæ²¿æŒ‡å®šç»´çš„å¼ é‡å½¢çŠ¶å¤§å°ä¸èƒ½è¢«split_sizeæ•´åˆ†ï¼Œåˆ™æœ€åä¸€ä¸ªåˆ†å—ä¼šå°äºå…¶å®ƒåˆ†å—ã€‚

```python
In [2]: x = torch.randn(3, 10, 6)                               

In [3]: x                                                       
Out[3]: 
tensor([[[-0.8775, -0.4960,  1.2960, -0.7834,  1.1593,  0.8485],
         [-1.3548, -1.0891,  0.3011,  0.5822,  0.1337, -0.9977],
         [-0.6412, -0.3102, -0.1618,  1.1270, -0.9163,  0.7583],
         [ 0.9933,  0.9254,  1.6719, -0.2064,  0.1526, -0.5263],
         [ 0.7706, -0.9688,  0.8912,  1.9223,  1.9731, -0.6831],
         [-0.0069,  0.2784,  1.2610, -0.3232, -1.1976, -0.1344],
         [ 0.0777,  0.7018, -0.5435, -0.8737, -0.4440,  1.0564],
         [ 0.1293, -0.8249,  0.7455,  1.2296,  0.4821,  1.3589],
         [ 0.3864, -1.4730,  0.6603,  0.5465,  0.1333, -0.7331],
         [ 1.7947, -0.5429, -1.0085,  0.6933,  0.6731, -1.2255]],

        [[ 0.0998, -0.0930, -0.4057,  0.2446,  0.7161,  0.3036],
         [-1.9477,  2.1896,  0.2929,  0.5595,  1.5185,  1.1661],
         [ 0.1391,  0.2492, -0.0041,  0.4088,  0.9216,  0.7747],
         [ 0.5324,  0.8214, -1.0135,  0.2731, -0.2142, -0.0330],
         [-0.7933,  1.4916,  0.0318,  0.5016, -0.0532, -1.2558],
         [-0.0261, -0.6143,  0.0034, -2.4476,  0.5431,  0.9995],
         [-1.4268,  1.0937, -1.7195,  0.9329,  2.3844,  0.0674],
         [ 1.2903,  1.1133, -0.9451, -0.7562, -0.8685, -0.6552],
         [ 0.7247, -2.1444, -0.0583,  0.0145,  0.6785, -0.3694],
         [ 1.3159,  0.1323, -1.5535,  1.4214, -0.7329, -0.6577]],

        [[ 0.8594, -0.7541,  0.4966, -0.2951, -0.7567,  1.3233],
         [-0.1438, -1.6067,  0.0128,  0.6936,  0.3204, -1.0199],
         [-0.4498,  1.3496,  0.7266,  0.3077,  0.1027,  0.2071],
         [ 0.8560,  0.6274,  1.2768, -0.9968,  0.6768, -0.5088],
         [ 0.2686, -0.3681, -1.1322,  0.9814,  0.9188, -0.1681],
         [-0.6616, -0.7909, -0.0702, -0.4303,  2.8490,  0.7392],
         [ 0.7906,  0.3060, -0.2649, -0.2921,  0.4829, -0.1724],
         [-0.1080,  0.9259,  0.0673, -0.4310,  0.1326,  0.2177],
         [ 0.8790,  1.0464,  1.4730, -1.7451,  1.1794, -0.0900],
         [-0.3713,  0.9280,  0.5084, -0.1260, -0.5660, -2.3400]]])

In [4]: a, b, c = x.split(1, 0)                                 

In [5]: a                                                       
Out[5]: 
tensor([[[-0.8775, -0.4960,  1.2960, -0.7834,  1.1593,  0.8485],
         [-1.3548, -1.0891,  0.3011,  0.5822,  0.1337, -0.9977],
         [-0.6412, -0.3102, -0.1618,  1.1270, -0.9163,  0.7583],
         [ 0.9933,  0.9254,  1.6719, -0.2064,  0.1526, -0.5263],
         [ 0.7706, -0.9688,  0.8912,  1.9223,  1.9731, -0.6831],
         [-0.0069,  0.2784,  1.2610, -0.3232, -1.1976, -0.1344],
         [ 0.0777,  0.7018, -0.5435, -0.8737, -0.4440,  1.0564],
         [ 0.1293, -0.8249,  0.7455,  1.2296,  0.4821,  1.3589],
         [ 0.3864, -1.4730,  0.6603,  0.5465,  0.1333, -0.7331],
         [ 1.7947, -0.5429, -1.0085,  0.6933,  0.6731, -1.2255]]])

In [6]: b                                                       
Out[6]: 
tensor([[[ 0.0998, -0.0930, -0.4057,  0.2446,  0.7161,  0.3036],
         [-1.9477,  2.1896,  0.2929,  0.5595,  1.5185,  1.1661],
         [ 0.1391,  0.2492, -0.0041,  0.4088,  0.9216,  0.7747],
         [ 0.5324,  0.8214, -1.0135,  0.2731, -0.2142, -0.0330],
         [-0.7933,  1.4916,  0.0318,  0.5016, -0.0532, -1.2558],
         [-0.0261, -0.6143,  0.0034, -2.4476,  0.5431,  0.9995],
         [-1.4268,  1.0937, -1.7195,  0.9329,  2.3844,  0.0674],
         [ 1.2903,  1.1133, -0.9451, -0.7562, -0.8685, -0.6552],
         [ 0.7247, -2.1444, -0.0583,  0.0145,  0.6785, -0.3694],
         [ 1.3159,  0.1323, -1.5535,  1.4214, -0.7329, -0.6577]]])

In [7]: c                                                       
Out[7]: 
tensor([[[ 0.8594, -0.7541,  0.4966, -0.2951, -0.7567,  1.3233],
         [-0.1438, -1.6067,  0.0128,  0.6936,  0.3204, -1.0199],
         [-0.4498,  1.3496,  0.7266,  0.3077,  0.1027,  0.2071],
         [ 0.8560,  0.6274,  1.2768, -0.9968,  0.6768, -0.5088],
         [ 0.2686, -0.3681, -1.1322,  0.9814,  0.9188, -0.1681],
         [-0.6616, -0.7909, -0.0702, -0.4303,  2.8490,  0.7392],
         [ 0.7906,  0.3060, -0.2649, -0.2921,  0.4829, -0.1724],
         [-0.1080,  0.9259,  0.0673, -0.4310,  0.1326,  0.2177],
         [ 0.8790,  1.0464,  1.4730, -1.7451,  1.1794, -0.0900],
         [-0.3713,  0.9280,  0.5084, -0.1260, -0.5660, -2.3400]]])

In [8]: d, e = x.split(2, 0)                                    

In [9]: d                                                       
Out[9]: 
tensor([[[-0.8775, -0.4960,  1.2960, -0.7834,  1.1593,  0.8485],
         [-1.3548, -1.0891,  0.3011,  0.5822,  0.1337, -0.9977],
         [-0.6412, -0.3102, -0.1618,  1.1270, -0.9163,  0.7583],
         [ 0.9933,  0.9254,  1.6719, -0.2064,  0.1526, -0.5263],
         [ 0.7706, -0.9688,  0.8912,  1.9223,  1.9731, -0.6831],
         [-0.0069,  0.2784,  1.2610, -0.3232, -1.1976, -0.1344],
         [ 0.0777,  0.7018, -0.5435, -0.8737, -0.4440,  1.0564],
         [ 0.1293, -0.8249,  0.7455,  1.2296,  0.4821,  1.3589],
         [ 0.3864, -1.4730,  0.6603,  0.5465,  0.1333, -0.7331],
         [ 1.7947, -0.5429, -1.0085,  0.6933,  0.6731, -1.2255]],

        [[ 0.0998, -0.0930, -0.4057,  0.2446,  0.7161,  0.3036],
         [-1.9477,  2.1896,  0.2929,  0.5595,  1.5185,  1.1661],
         [ 0.1391,  0.2492, -0.0041,  0.4088,  0.9216,  0.7747],
         [ 0.5324,  0.8214, -1.0135,  0.2731, -0.2142, -0.0330],
         [-0.7933,  1.4916,  0.0318,  0.5016, -0.0532, -1.2558],
         [-0.0261, -0.6143,  0.0034, -2.4476,  0.5431,  0.9995],
         [-1.4268,  1.0937, -1.7195,  0.9329,  2.3844,  0.0674],
         [ 1.2903,  1.1133, -0.9451, -0.7562, -0.8685, -0.6552],
         [ 0.7247, -2.1444, -0.0583,  0.0145,  0.6785, -0.3694],
         [ 1.3159,  0.1323, -1.5535,  1.4214, -0.7329, -0.6577]]])

In [10]: e                                                      
Out[10]: 
tensor([[[ 0.8594, -0.7541,  0.4966, -0.2951, -0.7567,  1.3233],
         [-0.1438, -1.6067,  0.0128,  0.6936,  0.3204, -1.0199],
         [-0.4498,  1.3496,  0.7266,  0.3077,  0.1027,  0.2071],
         [ 0.8560,  0.6274,  1.2768, -0.9968,  0.6768, -0.5088],
         [ 0.2686, -0.3681, -1.1322,  0.9814,  0.9188, -0.1681],
         [-0.6616, -0.7909, -0.0702, -0.4303,  2.8490,  0.7392],
         [ 0.7906,  0.3060, -0.2649, -0.2921,  0.4829, -0.1724],
         [-0.1080,  0.9259,  0.0673, -0.4310,  0.1326,  0.2177],
         [ 0.8790,  1.0464,  1.4730, -1.7451,  1.1794, -0.0900],
         [-0.3713,  0.9280,  0.5084, -0.1260, -0.5660, -2.3400]]])

In [11]: a.dtype, b.dtype, c.dtype, d.dtype, e.dtype            
Out[11]: (torch.float32, torch.float32, torch.float32, torch.float32, torch.float32)
  
In [12]: a.shape, b.shape, c.shape, d.shape, e.shape            
Out[12]: 
(torch.Size([1, 10, 6]),
 torch.Size([1, 10, 6]),
 torch.Size([1, 10, 6]),
 torch.Size([2, 10, 6]),
 torch.Size([1, 10, 6]))
```

é€æ¡çœ‹å„ä¸ªå‘½ä»¤ï¼š

```python
x = torch.randn(3, 10, 6) # ç”Ÿæˆä¸€ä¸ª(3, 10, 6)çš„xå¼ é‡
a, b, c = x.split(1, 0)   # åŸºäºç¬¬0ç»´ï¼ŒæŠŠxåˆ†ä¸º3ä¸ªå¼ é‡ï¼Œäºæ˜¯æ¯ä¸ªå¼ é‡shapeä¿±ä¸º(1, 10, 6)
d, e = x.split(2, 0)      # åŸºäºç¬¬0ç»´ï¼ŒæŠŠxåˆ†ä¸º2ä¸ªå¼ é‡ï¼Œç¬¬ä¸€ä¸ªå¼ é‡çš„shapeä¸º(2, 10, 6)ï¼Œå‰©ä¸‹çš„å¼ é‡split_sizeä¸è¶³2äº†ï¼Œæ‰€ä»¥ç¬¬äºŒä¸ªå¼ é‡çš„shapeä¸º(1, 10, 6)
```

***å½“`split_size`ä¸º`list`åˆ—è¡¨æ—¶***ï¼š

å‚è€ƒï¼š[https://www.codetd.com/article/8938026](https://www.codetd.com/article/8938026)

```python
In [2]: x = torch.rand(3, 8, 6)                                 

In [3]: xa, xb, xc = torch.split(x, [2, 1, 5], dim=1)           

In [4]: xa.shape, xb.shape, xc.shape                            
Out[4]: (torch.Size([3, 2, 6]), torch.Size([3, 1, 6]), torch.Size([3, 5, 6]))
```

å¦‚ä¸Šå®ä¾‹ä¸­æ‰€ç¤ºï¼Œå¼ é‡xåŸºäºç¬¬1ç»´ï¼ˆå®é™…çš„ç¬¬**äºŒ**ç»´ï¼‰è¢«åˆ†ä¸º`[2, 1, 5]`ä¸‰ä¸ªå¼ é‡ï¼Œæ­¤ä¾‹ä¸­ï¼Œxçš„ç¬¬äºŒç»´ä¸º8ï¼Œæ‰€ä»¥åˆ†æˆçš„ä¸‰ä¸ªå¼ é‡åŠ å’Œä¹Ÿå¿…é¡»ç­‰äº8ï¼Œå³`2+1+5=8`ã€‚å¦åˆ™ï¼Œä¼šæŠ¥é”™ã€‚

```python
In [5]: xi = torch.split(x, [2, 1, 1], dim=1)                                                                                     
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)
<ipython-input-5-5cd84dcf8582> in <module>
----> 1 xi = torch.split(x, [2, 1, 1], dim=1)

/usr/local/Caskroom/miniconda/base/lib/python3.7/site-packages/torch/functional.py in split(tensor, split_size_or_sections, dim)
     85     # split_size_or_sections. The branching code is in tensor.py, which we
     86     # call here.
---> 87     return tensor.split(split_size_or_sections, dim)
     88 
     89 # equivalent to itertools.product(indices)

/usr/local/Caskroom/miniconda/base/lib/python3.7/site-packages/torch/tensor.py in split(self, split_size, dim)
    384                 return super(Tensor, self).split_with_sizes(split_size, dim)
    385         else:
--> 386             return super(Tensor, self).split_with_sizes(split_size, dim)
    387 
    388     def unique(self, sorted=True, return_inverse=False, return_counts=False, dim=None):

RuntimeError: split_with_sizes expects split_sizes to sum exactly to 8 (input tensor's size at dimension 1), but got split_sizes=[2, 1, 1]
```

æŠ¥é”™ä¿¡æ¯ï¼š`RuntimeError: split_with_sizes expects split_sizes to sum exactly to 8 (input tensor's size at dimension 1), but got split_sizes=[2, 1, 1]`ï¼Œè¦æ±‚åˆ†å‰²`list`å„å€¼çš„åŠ å’Œä¸å¼ é‡ç›¸åº”ç»´åº¦çš„å€¼å¿…é¡»ç›¸ç­‰ã€‚

(2) **torch.chunk()**

å‚è€ƒï¼š[https://www.codetd.com/article/8938026](https://www.codetd.com/article/8938026)

`torch.chunk(input, chunks)`åŸºæœ¬ä½¿ç”¨å’Œ`torch.split()`ç›¸åŒã€‚`input`ä¸ºéœ€è¦åˆ‡åˆ†çš„tensorï¼Œ`chunks`(intå‹)ä¸ºéœ€è¦åˆ‡åˆ†åçš„å—å¤§å°ï¼Œ`dim`ä¸ºåˆ‡åˆ†çš„ç»´åº¦ã€‚

åŒºåˆ«ï¼š

* `chunks`åªèƒ½æ˜¯`int`å‹ï¼Œè€Œ`torch.split`ä¸­`split_size`å¯ä»¥æ˜¯listï¼›
* `chunks`åœ¨å—å€¼å°äºè¯¥ç»´åº¦å€¼æ—¶ï¼Œä¼šå°†å—æŒ‰ç…§ç»´åº¦åˆ‡åˆ†æˆ1çš„ç»“æ„ã€‚è€Œsplitåˆ™ä¼šè¿”å›åŸæ¥çš„å¼ é‡ã€‚

```python
In [2]: x = torch.rand(2, 4, 6)                                 

In [3]: y = torch.chunk(x, 5, dim=1)                            

In [6]: for i in y: 
   ...:     print(i.size()) 
   ...:                                                         
torch.Size([2, 1, 6])
torch.Size([2, 1, 6])
torch.Size([2, 1, 6])
torch.Size([2, 1, 6])

In [7]: x.size()                                                
Out[7]: torch.Size([2, 4, 6])

In [8]: yy = torch.split(x, 5, dim=1) 
  
In [11]: for i in yy: 
    ...:     print(i.size()) 
    ...:                                                                                                                          
torch.Size([2, 4, 6])
```

###### 4.1.4 mutation

(1) **torch.transpose()**

å‚è€ƒï¼š[https://www.cnblogs.com/yifdu25/p/9399047.html](https://www.cnblogs.com/yifdu25/p/9399047.html)

äº¤æ¢ç»´åº¦ã€‚

```python
In [2]: x = torch.randn(2, 3)                                   

In [3]: x                                                       
Out[3]: 
tensor([[-0.2395, -1.3414, -0.7900],
        [ 0.0117,  0.5133, -0.1420]])

In [4]: x.transpose(0, 1)                                       
Out[4]: 
tensor([[-0.2395,  0.0117],
        [-1.3414,  0.5133],
        [-0.7900, -0.1420]])
```

(2) **torch.t()**

å‚è€ƒï¼š[https://blog.csdn.net/foneone/article/details/103876131](https://blog.csdn.net/foneone/article/details/103876131)

`torch.t()`æ˜¯ä¸€ä¸ªç±»ä¼¼äºæ±‚çŸ©é˜µçš„è½¬ç½®çš„å‡½æ•°ï¼Œä½†æ˜¯å®ƒè¦æ±‚è¾“å…¥çš„tensorç»“æ„ç»´åº¦<=2Dã€‚

å½“è¾“å…¥å¼ é‡ç»´åº¦ä¸º2ç»´æ—¶ï¼Œè¾“å‡ºè½¬ç½®åçš„å¼ é‡ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š

```python
In [2]: x = torch.rand(1, 5)                                    

In [3]: x                                                       
Out[3]: tensor([[0.0980, 0.8057, 0.1076, 0.5593, 0.3623]])

In [4]: x.t()                                                   
Out[4]: 
tensor([[0.0980],
        [0.8057],
        [0.1076],
        [0.5593],
        [0.3623]])
```

è¾“å…¥å¼ é‡ä¸º1ç»´æ—¶ï¼Œä¸åšæ“ä½œï¼Œè¾“å‡ºåŸå¼ é‡ï¼š

```python
In [5]: x = torch.rand(5)                                       

In [6]: x                                                       
Out[6]: tensor([0.3640, 0.5733, 0.0280, 0.4891, 0.6522])

In [7]: x.size()                                                
Out[7]: torch.Size([5])

In [8]: x.t()                                                   
Out[8]: tensor([0.3640, 0.5733, 0.0280, 0.4891, 0.6522])

In [9]: x.t().size()                                            
Out[9]: torch.Size([5])
```

(3) **torch.squeeze()** & **torch.unsqueeze()**

å‚è€ƒ:

[https://www.cnblogs.com/yifdu25/p/9399047.html](https://www.cnblogs.com/yifdu25/p/9399047.html)ï¼›

[https://blog.csdn.net/xiexu911/article/details/80820028](https://blog.csdn.net/xiexu911/article/details/80820028)

squeezeå’Œunsqueezeçš„ç”¨æ³•ä¸»è¦æ˜¯å¯¹æ•°æ®çš„ç»´åº¦è¿›è¡Œå‹ç¼©æˆ–è€…è§£å‹ã€‚ï¼ˆè¿™å¥è¯ä¸€ç‚¹è¥å…»éƒ½æ²¡æœ‰ğŸ¤­ğŸ¤­ğŸ˜¬)

å‡½æ•°åŠŸèƒ½ï¼šå»æ‰sizeä¸º1çš„ç»´åº¦ï¼ŒåŒ…æ‹¬è¡Œå’Œåˆ—ã€‚**å½“ç»´åº¦å¤§äºç­‰äº2æ—¶ï¼Œsqueeze()æ— ä½œç”¨**ï¼Œ**å½“ç»´åº¦å¤§äºç­‰äº2æ—¶ï¼Œsqueeze()æ— ä½œç”¨**ã€‚

å…¶ä¸­ï¼Œ`squeeze(0)`ä»£è¡¨ç¬¬ä¸€ç»´åº¦å€¼ä¸º1åˆ™å»é™¤ç¬¬ä¸€ç»´åº¦ï¼Œ`squeeze(1)`ä»£è¡¨è‹¥ç¬¬äºŒç»´åº¦ä¸º1åˆ™å»é™¤ç¬¬äºŒç»´åº¦ã€‚

ç”¨å®ä¾‹å­¦ä¹ æœ€é è°±ï¼š

```python
In [2]: x = torch.randn(1, 3)                                                                                                     
In [3]: x                                                                                                                         
Out[3]: tensor([[-0.0217,  1.5953,  0.5264]])

In [4]: xs = x.squeeze(0)                                                                                                         
In [5]: xs                                                                                                                        
Out[5]: tensor([-0.0217,  1.5953,  0.5264])

In [6]: x.size(), xs.size()                                                                                                       
Out[6]: (torch.Size([1, 3]), torch.Size([3]))
```

ä¸Šè¿°å®ä¾‹å»é™¤äº†ç¬¬ä¸€ç»´åº¦ï¼Œä¸å¤ªæ˜æ˜¾ï¼Œç»§ç»­ï¼š

```python
In [2]: x = torch.randn(3, 1)                                   

In [3]: x                                                       
Out[3]: 
tensor([[-0.1502],
        [ 0.0505],
        [ 0.1177]])

In [4]: xx = x.squeeze(1)                                       

In [5]: xx                                                      
Out[5]: tensor([-0.1502,  0.0505,  0.1177])

In [6]: x.size(), xx.size()                                     
Out[6]: (torch.Size([3, 1]), torch.Size([3]))
```

ç¬¬äºŒç»´åº¦è¢«å»æ‰äº†ï¼Œåˆ—å˜æˆè¡Œäº†ï¼Œè¿™ä¸ªç”¨å¾—æ¯”è¾ƒå¤šã€‚

`unqueeze`æŠŠä¸Šè¿°æ“ä½œæ¢å¤å›æ¥ï¼š

```python
In [9]: xx.unsqueeze(1)                                         
Out[9]: 
tensor([[-0.1502],
        [ 0.0505],
        [ 0.1177]])
        
In [10]: xx.unsqueeze(0)                                        
Out[10]: tensor([[-0.1502,  0.0505,  0.1177]])
```

è‡ªå·±ä½“ä¼šå§ï¼Œæœ‰ç‚¹è¡¨è¾¾ä¸å‡ºæ¥äº†ğŸ¥µã€‚

(4) **torch.reshape()**

å‚è€ƒï¼š[https://blog.csdn.net/GhostintheCode/article/details/102531237](https://blog.csdn.net/GhostintheCode/article/details/102531237)

`torch.reshape(input, shape)`è¿”å›å…·æœ‰ä¸inputç›¸åŒçš„æ•°æ®å’Œå…ƒç´ æ•°é‡çš„å¼ é‡ï¼Œå…·æœ‰æŒ‡å®šå½¢çŠ¶shapeã€‚

```python
In [2]: a = torch.arange(6.)                                    

In [3]: a                                                       
Out[3]: tensor([0., 1., 2., 3., 4., 5.])

In [4]: torch.reshape(a, (2, 3))                                
Out[4]: 
tensor([[0., 1., 2.],
        [3., 4., 5.]])
```

è‹¥shapeåªæœ‰ä¸€ä¸ª-1ï¼Œå°±æ˜¯ç›´æ¥å±•å¼€ã€‚

```python
In [2]: a = torch.tensor([[1, 2], [3, 4]])                      

In [3]: a                                                       
Out[3]: 
tensor([[1, 2],
        [3, 4]])

In [4]: torch.reshape(a, (-1,))  # shapeåªæœ‰ä¸€ä¸ª-1                         
Out[4]: tensor([1, 2, 3, 4])     # å¼ é‡ç›´æ¥å±•å¼€
```

è‹¥shapeæŸä¸ªå°ºå¯¸ä¸º-1ï¼Œåˆ™å‰©ä½™å°ºå¯¸æ ¹æ®è¾“å…¥çš„å…ƒç´ æ¨æ–­å‡ºæ¥ã€‚

```python
In [2]: a = torch.arange(8.)                                    

In [3]: a                                                       
Out[3]: tensor([0., 1., 2., 3., 4., 5., 6., 7.])

In [4]: torch.reshape(a, (-1, 4)) # ç»™å®šä¸€ä¸ªï¼Œå¦ä¸€ä¸ªèƒ½ç®—å‡ºæ¥                 
Out[4]: 
tensor([[0., 1., 2., 3.],
        [4., 5., 6., 7.]])
```

(5) **torch.unbind()**

å‚è€ƒï¼š[https://zhuanlan.zhihu.com/p/36233589](https://zhuanlan.zhihu.com/p/36233589)

è§£é™¤dimç»‘å®šï¼ŒæŠŠå¼ é‡è¿›è¡Œæ‹†åˆ†ã€‚

```python
In [2]: x = torch.randn((5, 3))                                 

In [3]: x                                                       
Out[3]: 
tensor([[ 0.3580,  0.9733, -0.5895],
        [ 0.3258,  0.6766, -0.8588],
        [-0.1140, -1.4491, -0.4318],
        [-0.6378, -0.5162,  1.5366],
        [ 0.6458, -0.3919, -1.5191]])

In [4]: x.unbind()                                              
Out[4]: 
(tensor([ 0.3580,  0.9733, -0.5895]),
 tensor([ 0.3258,  0.6766, -0.8588]),
 tensor([-0.1140, -1.4491, -0.4318]),
 tensor([-0.6378, -0.5162,  1.5366]),
 tensor([ 0.6458, -0.3919, -1.5191]))
```

(6) **torch.where()**

å‚è€ƒï¼š

[https://www.jianshu.com/p/439f0e48618e](https://www.jianshu.com/p/439f0e48618e)

[https://blog.csdn.net/xijuezhu8128/article/details/86590562](https://blog.csdn.net/xijuezhu8128/article/details/86590562)

`torch.where(condition, x, y)`å‡½æ•°åŠŸèƒ½å¦‚ä¸‹ï¼š

* é’ˆå¯¹äºxè€Œè¨€ï¼Œå¦‚æœå…¶ä¸­çš„å…ƒç´ æ»¡è¶³conditionï¼Œå°±è¿”å›xçš„å€¼ï¼›ä¸æ»¡è¶³conditionçš„å…ƒç´ ï¼Œå°†å¯¹åº”ä½ç½®æ›¿æ¢ä¸ºyçš„å€¼ï¼›
* ä¸‰ä¸ªè¾“å…¥å‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆ¤æ–­æ¡ä»¶ï¼Œç¬¬äºŒä¸ªæ˜¯ç¬¦åˆæ¡ä»¶çš„è®¾ç½®å€¼ï¼Œç¬¬ä¸‰ä¸ªæ˜¯ä¸æ»¡è¶³æ¡ä»¶çš„è®¾ç½®å€¼ã€‚

```python
In [2]: x = torch.randn(3, 2)                                   

In [3]: y = torch.ones(3, 2)                                    

In [4]: x                                                       
Out[4]: 
tensor([[-0.0106,  0.1663],
        [-0.6484, -0.3316],
        [ 0.4814, -1.9186]])

In [5]: y                                                       
Out[5]: 
tensor([[1., 1.],
        [1., 1.],
        [1., 1.]])

In [6]: torch.where(x > 0, x, y)                                
Out[6]: 
tensor([[1.0000, 0.1663],
        [1.0000, 1.0000],
        [0.4814, 1.0000]])
```

æ¢ç§æ–¹å¼ï¼š

```python
In [2]: x = torch.randn(3, 2)                                   

In [3]: x                                                       
Out[3]: 
tensor([[ 0.1856,  1.1246],
        [-0.7023, -0.2031],
        [ 0.9781, -0.4329]])

In [4]: y = torch.tensor(3.0)                                   

In [5]: y                                                       
Out[5]: tensor(3.)

In [6]: torch.where(x > 0.5, x, y)                              
Out[6]: 
tensor([[3.0000, 1.1246],
        [3.0000, 3.0000],
        [0.9781, 3.0000]])
```

(7) **torch.nonzero()**

`torch.nonzero()`è¿”å›éé›¶å€¼çš„ç´¢å¼•ã€‚

```python
In [2]: torch.nonzero(torch.tensor([1., 1., 1., 0., 1.]))       
Out[2]: 
tensor([[0],
        [1],
        [2],
        [4]])
```

ç¬¬ä¸€ã€äºŒã€ä¸‰ã€äº”ä¸ªå…ƒç´ æ˜¯1éé›¶ï¼Œæ‰€ä»¥è¿”å›çš„ç´¢å¼•æ˜¯0ã€1ã€2ã€4ã€‚

å¯¹äºé«˜ç»´åº¦å¼ é‡ï¼š

```python
In [3]: torch.nonzero(torch.tensor([[0.6, 0.0, 0.0, 0.0], 
   ...:                             [0.0, 0.4, 0.0, 0.0], 
   ...:                             [0.0, 0.0, 1.2, 0.0], 
   ...:                             [0.0, 0.0, 0.0,-0.4]]))     
Out[3]: 
tensor([[0, 0],
        [1, 1],
        [2, 2],
        [3, 3]])
```

##### 4.2 ç‚¹å¯¹ç‚¹æ“ä½œ

###### 4.2.1 ä¸‰è§’å‡½æ•°

```python
In [3]: torch.abs(torch.tensor([-1.2, -0.23, 1.34]))            
Out[3]: tensor([1.2000, 0.2300, 1.3400])

In [4]: torch.acos(torch.tensor(0.5))                           
Out[4]: tensor(1.0472)

In [5]: torch.asin(torch.tensor(0.5))                           
Out[5]: tensor(0.5236)

In [6]: torch.atan(torch.tensor(1.))                            
Out[6]: tensor(0.7854)

In [7]: torch.atan2(torch.tensor(1.7321), torch.tensor(2))      
Out[7]: tensor(0.7137)

In [9]: torch.cos(torch.tensor(1.0472))                         
Out[9]: tensor(0.5000)

In [10]: torch.cosh(torch.tensor(1.2))                          
Out[10]: tensor(1.8107)

In [11]: torch.sin(torch.tensor(0.5236))                        
Out[11]: tensor(0.5000)

In [12]: torch.sinh(torch.tensor(1.2))                          
Out[12]: tensor(1.5095)

In [13]: torch.tan(torch.tensor(1.0472))                        
Out[13]: tensor(1.7321)

In [14]: torch.tanh(torch.tensor(1.2))                          
Out[14]: tensor(0.8337)
```

ä»¥ä¸‹å…³äºatan2å‡½æ•°çš„å­¦ä¹ å‚è€ƒï¼š[https://baike.baidu.com/item/atan2/10931300](https://baike.baidu.com/item/atan2/10931300)

`atan2(a, b)` ä¸ `atan(a, b)`ç¨æœ‰ä¸åŒï¼Œ**ATAN2(a/b)**çš„å–å€¼èŒƒå›´ä»‹äº -ğœ‹åˆ°ğœ‹ä¹‹é—´ï¼ˆä¸åŒ…æ‹¬ -ğœ‹ï¼‰ï¼Œè€Œ**ATAN(a/b)**çš„å–å€¼èŒƒå›´ä»‹äº-ğœ‹/2åˆ°ğœ‹/2ä¹‹é—´ï¼ˆä¸åŒ…æ‹¬Â±ğœ‹/2)ã€‚

å¦å¤–è¦æ³¨æ„çš„æ˜¯ï¼Œå‡½æ•°`atan2(y, x)`ä¸­å‚æ•°çš„é¡ºåºæ˜¯å€’ç½®çš„ï¼Œ`atan2(y, x)`è®¡ç®—çš„å€¼ç›¸å½“äºç‚¹`(x, y)`çš„è§’åº¦å€¼ã€‚

###### 4.2.2 åŠ å‡ä¹˜é™¤

å‚è€ƒï¼š[https://www.jb51.net/article/177464.htm](https://www.jb51.net/article/177464.htm)

åŠ å‡ï¼š

```python
In [2]: a = torch.randn(3, 4)                                   

In [3]: a                                                       
Out[3]: 
tensor([[-0.5624,  0.5580,  0.9760,  0.1236],
        [-0.0491, -0.4877,  0.3196, -1.5708],
        [-0.8361,  1.0775, -0.0376,  0.2628]])

In [4]: b = torch.rand(4)                                       

In [5]: b                                                       
Out[5]: tensor([0.4848, 0.8852, 0.9253, 0.6578])

In [6]: torch.add(a, b)                                         
Out[6]: 
tensor([[-0.0776,  1.4432,  1.9012,  0.7814],
        [ 0.4356,  0.3975,  1.2449, -0.9130],
        [-0.3514,  1.9627,  0.8877,  0.9205]])

In [9]: torch.sub(a, b)                                         
Out[9]: 
tensor([[-1.0472, -0.3272,  0.0507, -0.5342],
        [-0.5339, -1.3729, -0.6057, -2.2286],
        [-1.3209,  0.1923, -0.9629, -0.3950]])
```

ç‚¹ä¹˜ï¼š

```python
In [11]: a                                                      
Out[11]: 
tensor([[-0.5624,  0.5580,  0.9760,  0.1236],
        [-0.0491, -0.4877,  0.3196, -1.5708],
        [-0.8361,  1.0775, -0.0376,  0.2628]])

In [12]: b                                                      
Out[12]: tensor([0.4848, 0.8852, 0.9253, 0.6578])

In [13]: torch.mul(a, b)                                        
Out[13]: 
tensor([[-0.2726,  0.4939,  0.9030,  0.0813],
        [-0.0238, -0.4317,  0.2957, -1.0333],
        [-0.4053,  0.9538, -0.0348,  0.1728]])
```

ç‚¹é™¤ï¼š

```python
In [14]: a                                                      
Out[14]: 
tensor([[-0.5624,  0.5580,  0.9760,  0.1236],
        [-0.0491, -0.4877,  0.3196, -1.5708],
        [-0.8361,  1.0775, -0.0376,  0.2628]])

In [15]: b                                                      
Out[15]: tensor([0.4848, 0.8852, 0.9253, 0.6578])

In [16]: torch.div(a, b)                                        
Out[16]: 
tensor([[-1.1601,  0.6304,  1.0548,  0.1880],
        [-0.1014, -0.5510,  0.3454, -2.3881],
        [-1.7248,  1.2172, -0.0406,  0.3994]])
```

çŸ©é˜µç›¸ä¹˜ï¼š

åŒ…æ‹¬`torch.mm()`ã€`torch.matmul()`ã€`@`ï¼Œæ•ˆæœä¸€æ ·ã€‚

```python
In [4]: a                                                       
Out[4]: 
tensor([[-0.5178],
        [ 1.0223],
        [-0.3267]])

In [5]: b                                                       
Out[5]: tensor([[ 0.4189, -0.3158]])

In [6]: torch.mm(a, b)                                          
Out[6]: 
tensor([[-0.2169,  0.1635],
        [ 0.4282, -0.3229],
        [-0.1368,  0.1032]])

In [7]: torch.matmul(a, b)                                      
Out[7]: 
tensor([[-0.2169,  0.1635],
        [ 0.4282, -0.3229],
        [-0.1368,  0.1032]])

In [8]: a @ b                                                   
Out[8]: 
tensor([[-0.2169,  0.1635],
        [ 0.4282, -0.3229],
        [-0.1368,  0.1032]])
```

###### 4.2.3 å¯¹æ•°è¿ç®—

å‚è€ƒï¼š[https://zhuanlan.zhihu.com/p/36233589](https://zhuanlan.zhihu.com/p/36233589)

```python
torch.log(input, out=None)    # y_i=log_e(x_i)
torch.log1p(input, out=None)  # y_i=log_e(x_i+1)
torch.log2(input, out=None)   # y_i=log_2(x_i)
torch.log10(input,out=None)   # y_i=log_10(x_i)
```

`torch.log()`å®ä¾‹å¦‚ä¸‹ï¼š

```python
In [3]: torch.log(torch.tensor(2.71828))                        
Out[3]: tensor(1.0000)
```

å¤æ‚ç‚¹çš„ï¼š

```
In [7]: epow = torch.randn(5, 4)                                

In [8]: epow                                                    
Out[8]: 
tensor([[-0.2526, -0.8183,  0.4722, -0.2324],
        [ 2.3240,  1.5123, -0.9960,  0.8525],
        [-0.0959, -0.1117,  1.5085, -0.6967],
        [ 1.7561, -0.1698, -1.4869, -0.1510],
        [ 0.8032, -1.6319,  0.9018, -0.6462]])

In [9]: a = torch.pow(torch.tensor(2.71828), epow)              

In [10]: a                                                      
Out[10]: 
tensor([[ 0.7768,  0.4412,  1.6036,  0.7926],
        [10.2164,  4.5373,  0.3694,  2.3455],
        [ 0.9086,  0.8943,  4.5198,  0.4982],
        [ 5.7896,  0.8439,  0.2261,  0.8598],
        [ 2.2328,  0.1956,  2.4640,  0.5240]])

In [11]: torch.log(a)                                           
Out[11]: 
tensor([[-0.2526, -0.8183,  0.4722, -0.2324],
        [ 2.3240,  1.5123, -0.9960,  0.8525],
        [-0.0959, -0.1117,  1.5085, -0.6967],
        [ 1.7561, -0.1698, -1.4869, -0.1510],
        [ 0.8032, -1.6319,  0.9018, -0.6462]])
```

`torch.log1p()`å®ä¾‹å¦‚ä¸‹ï¼š

```python
In [16]: torch.log1p(torch.tensor(1.71828))  # y_i=log_e(x_i+1)ï¼Œç”¨2.71828 - 1
Out[16]: tensor(1.0000)
```

`torch.log2()`å®ä¾‹å¦‚ä¸‹ï¼š

```python
In [18]: torch.log2(torch.tensor(8.))                           
Out[18]: tensor(3.)
```

`torch.log10()`å®ä¾‹å¦‚ä¸‹ï¼š

```python
In [19]: torch.log10(torch.tensor(1000.))                       
Out[19]: tensor(3.)
```

###### 4.2.4 å¹‚å‡½æ•°

```python
torch.pow(input, exponent, out=None)  # y_i=input^(exponent)
```

å®ä¾‹å¦‚ä¸‹ï¼š

```python
In [2]: torch.pow(torch.tensor(2), 3)                           
Out[2]: tensor(8)

In [3]: torch.pow(torch.randn(2, 3), 3)                         
Out[3]: 
tensor([[-0.0034, -0.0333,  0.0436],
        [-0.1628,  0.0019, -0.0073]])
```

###### 4.2.5 æŒ‡æ•°è¿ç®—

```python
torch.exp(tensor, out=None)     # y_i=e^(x_i)
torch.expm1(tensor, out=None)   # y_i=e^(x_i) -1
```

å®ä¾‹å¦‚ä¸‹ï¼š

```python
In [6]: torch.exp(torch.tensor(0.))                             
Out[6]: tensor(1.)

In [7]: torch.expm1(torch.tensor(0.))                           
Out[7]: tensor(0.)
```

###### 4.2.6 æˆªæ–­å‡½æ•°

```python
torch.ceil(input, out=None)   						# è¿”å›å‘æ­£æ–¹å‘å–å¾—æœ€å°æ•´æ•°
torch.floor(input, out=None)  						# è¿”å›å‘è´Ÿæ–¹å‘å–å¾—æœ€å¤§æ•´æ•°

torch.round(input, out=None)  						# è¿”å›ç›¸é‚»æœ€è¿‘çš„æ•´æ•°ï¼Œå››èˆäº”å…¥

torch.trunc(input, out=None)  						# è¿”å›æ•´æ•°éƒ¨åˆ†æ•°å€¼
torch.frac(tensor, out=None)  						# è¿”å›å°æ•°éƒ¨åˆ†æ•°å€¼

torch.fmod(input, divisor, out=None)  		# è¿”å›input/divisorçš„ä½™æ•°
torch.remainder(input, divisor, out=None) # åŒä¸Š
```

###### 4.2.7 å…¶ä»–è¿ç®—

```python
torch.erf(tensorï¼Œ out=None)
torch.erfinv(tensor, out=None)
torch.sigmoid(input, out=None)
torch.clamp(input, min, max, out=None) # è¿”å›input<min,åˆ™è¿”å›minï¼Œinput>max,åˆ™è¿”å›max,å…¶ä½™è¿”å›input
torch.neg(input, out=None) 						 # out_i=-1*(input)
torch.reciprocal(input, out=None)  		 # out_i= 1/input_i
torch.sqrt(input, out=None)  					 # out_i=sqrt(input_i)
torch.rsqrt(input, out=None)					 # out_i=1/(sqrt(input_i))
torch.sign(input, out=None)  					 # out_i=sin(input_i)  å¤§äº0ä¸º1ï¼Œå°äº0ä¸º-1
torch.lerp(start, end, weight, out=None)
```

##### 4.3 é™ç»´æ“ä½œ

```python
torch.argmax(input, dim=None, keepdim=False)  # è¿”å›æœ€å¤§å€¼æ’åºçš„ç´¢å¼•å€¼
torch.argmin(input, dim=None, keepdim=False)  # è¿”å›æœ€å°å€¼æ’åºçš„ç´¢å¼•å€¼

torch.cumprod(input, dim, out=None)  					# y_i=x_1 * x_2 * x_3 *â€¦* x_i
torch.cumsum(input, dim, out=None)  					# y_i=x_1 + x_2 + â€¦ + x_i

torch.dist(input, out, p=2)       						# è¿”å›inputå’Œoutçš„på¼è·ç¦»
torch.mean()                     						  # è¿”å›å¹³å‡å€¼
torch.sum()                      						  # è¿”å›æ€»å’Œ
torch.median(input)               						# è¿”å›ä¸­é—´å€¼
torch.mode(input)                						  # è¿”å›ä¼—æ•°å€¼
torch.unique(input, sorted=False) 						# è¿”å›1-Dçš„å”¯ä¸€çš„tensor,æ¯ä¸ªæ•°å€¼è¿”å›ä¸€æ¬¡.
>>> output = torch.unique(torch.tensor([1, 3, 2, 3], dtype=torch.long))
>>> output
tensor([ 2,  3,  1])

torch.std()  																	# è¿”å›æ ‡å‡†å·®
torch.var() 																	# è¿”å›æ–¹å·®

torch.norm(input, p=2) 												# è¿”å›p-normçš„èŒƒå¼
torch.prod(input, dim, keepdim=False) 				# è¿”å›æŒ‡å®šç»´åº¦æ¯ä¸€è¡Œçš„ä¹˜ç§¯
```

##### 4.4 å¯¹æ¯”æ“ä½œ

```python
torch.eq(input, other, out=None)  		# æŒ‰æˆå‘˜è¿›è¡Œç­‰å¼æ“ä½œï¼Œç›¸åŒè¿”å›1
torch.equal(tensor1, tensor2) 				# å¦‚æœtensor1å’Œtensor2æœ‰ç›¸åŒçš„sizeå’Œelementsï¼Œåˆ™ä¸ºtrue
>>> torch.eq(torch.tensor([[1, 2], [3, 4]]), torch.tensor([[1, 1], [4, 4]]))
tensor([[ 1,  0],
        [ 0,  1]], dtype=torch.uint8)

torch.ge(input, other, out=None)   		# input>= other
torch.gt(input, other, out=None)   		# input>other
torch.le(input, other, out=None)    	# input=<other
torch.lt(input, other, out=None)   	  # input<other
torch.ne(input, other, out=None)  		# input != other ä¸ç­‰äº

torch.max()                       	  # è¿”å›æœ€å¤§å€¼
torch.min()                       	  # è¿”å›æœ€å°å€¼
torch.isnan(tensor) 									# åˆ¤æ–­æ˜¯å¦ä¸ºâ€™nanâ€™
torch.sort(input, dim=None, descending=False, out=None) # å¯¹ç›®æ ‡inputè¿›è¡Œæ’åº
torch.topk(input, k, dim=None, largest=True, sorted=True, out=None)  # æ²¿ç€æŒ‡å®šç»´åº¦è¿”å›æœ€å¤§kä¸ªæ•°å€¼åŠå…¶ç´¢å¼•å€¼
torch.kthvalue(input, k, dim=None, deepdim=False, out=None) # æ²¿ç€æŒ‡å®šç»´åº¦è¿”å›æœ€å°kä¸ªæ•°å€¼åŠå…¶ç´¢å¼•å€¼
```

##### 4.5 é¢‘è°±æ“ä½œ

ç›®å‰ä¸å¤§æ‡‚ï¼Œå…ˆæŠ„ä¸‹æ¥ç•™å­˜ã€‚

```python
torch.fft(input, signal_ndim, normalized=False)
torch.ifft(input, signal_ndim, normalized=False)
torch.rfft(input, signal_ndim, normalized=False, onesided=True)
torch.irfft(input, signal_ndim, normalized=False, onesided=True)
torch.stft(signa, frame_length, hop, â€¦)
```

##### 4.6 å…¶ä»–æ“ä½œ

```python
torch.cross(input, other, dim=-1, out=None)  						# å‰ä¹˜(å¤–ç§¯)
torch.dot(tensor1, tensor2)  														# è¿”å›tensor1å’Œtensor2çš„ç‚¹ä¹˜
torch.mm(mat1, mat2, out=None) 													# è¿”å›çŸ©é˜µmat1å’Œmat2çš„ä¹˜ç§¯
torch.eig(a, eigenvectors=False, out=None) 							# è¿”å›çŸ©é˜µaçš„ç‰¹å¾å€¼/ç‰¹å¾å‘é‡ 
torch.det(A)  																					# è¿”å›çŸ©é˜µAçš„è¡Œåˆ—å¼
torch.trace(input) 																			# è¿”å›2-dçŸ©é˜µçš„è¿¹(å¯¹å¯¹è§’å…ƒç´ æ±‚å’Œ)
torch.diag(input, diagonal=0, out=None)									# è¿”å›å¯¹è§’çº¿ä¸Šçš„å…ƒç´ 
torch.histc(input, bins=100, min=0, max=0, out=None) 		# è®¡ç®—inputçš„ç›´æ–¹å›¾
torch.tril(input, diagonal=0, out=None)  								# è¿”å›çŸ©é˜µçš„ä¸‹ä¸‰è§’çŸ©é˜µï¼Œå…¶ä»–ä¸º0
torch.triu(input, diagonal=0, out=None) 								# è¿”å›çŸ©é˜µçš„ä¸Šä¸‰è§’çŸ©é˜µï¼Œå…¶ä»–ä¸º0
```

#### 5. Tips

##### 5.1 è·å–Python number

```python
In [3]: a                                                       
Out[3]: 
tensor([[-0.7424, -0.7418,  0.3529],
        [-0.5532,  0.0865, -0.7361],
        [ 0.5913, -0.7325, -0.3438],
        [-0.3184, -0.7912, -1.2510],
        [-0.3555, -0.2875,  0.9544]])

In [4]: a[0]  # ç›´æ¥å–ç´¢å¼•è¿”å›çš„æ˜¯tensoræ•°æ®
Out[4]: tensor([-0.7424, -0.7418,  0.3529])

In [5]: a[0].item()                                             
----------------------------------------------------------------
ValueError                     Traceback (most recent call last)
<ipython-input-5-b8dd84f0b77f> in <module>
----> 1 a[0].item()

ValueError: only one element tensors can be converted to Python scalars

In [6]: a[0][1].item() # è·å–python numberï¼Œå…·ä½“æ•°æ®
Out[6]: -0.74179607629776
```

##### 5.2 tensorè®¾ç½®

###### 5.2.1 åˆ¤æ–­ç±»å‹

```python
torch.is_tensor()  # å¦‚æœæ˜¯pytorchçš„tensorç±»å‹è¿”å›true
torch.is_storage() # å¦‚æœæ˜¯pytorchçš„storageç±»å‹è¿”å›ture
```

`torch.Storage()`

å‚è€ƒï¼š 

[https://www.cnblogs.com/wanghui-garcia/p/10623033.html](https://www.cnblogs.com/wanghui-garcia/p/10623033.html)

[https://blog.csdn.net/Mr_JP/article/details/81906616](https://blog.csdn.net/Mr_JP/article/details/81906616)

tensoråˆ†ä¸ºå¤´ä¿¡æ¯åŒºï¼ˆTensorï¼‰å’Œå­˜å‚¨åŒºï¼ˆStorageï¼‰ã€‚

ä¿¡æ¯åŒºä¸»è¦ä¿å­˜ç€tensorçš„å½¢çŠ¶ï¼ˆsizeï¼‰ã€æ­¥é•¿ï¼ˆstrideï¼‰ã€æ•°æ®ç±»å‹ï¼ˆtypeï¼‰ç­‰ä¿¡æ¯ï¼Œè€ŒçœŸæ­£çš„æ•°æ®åˆ™ä¿å­˜æˆè¿ç»­æ•°ç»„ï¼Œå­˜å‚¨åœ¨å­˜å‚¨åŒºã€‚

```python
In [2]: a = torch.FloatTensor([1, 2, 3])                        

In [3]: a                                                       
Out[3]: tensor([1., 2., 3.])

In [4]: b = torch.FloatStorage([1, 2, 3])                       

In [5]: b                                                       
Out[5]: 
 1.0
 2.0
 3.0
[torch.FloatStorage of size 3]

In [6]: a.dtype, b.dtype                                        
Out[6]: (torch.float32, torch.float32)

In [7]: torch.is_tensor(a)                                      
Out[7]: True

In [8]: torch.is_storage(b)                                     
Out[8]: True
```

###### 5.2.2 è®¾ç½®é»˜è®¤

ä»¥ä¸‹ç•™å­˜å§ï¼Œç”¨çš„æ¯”è¾ƒå°‘ã€‚

```python
torch.set_default_dtype(d)  					# å¯¹torch.tensor() è®¾ç½®é»˜è®¤çš„æµ®ç‚¹ç±»å‹

torch.set_default_tensor_type() 			# åŒä¸Šï¼Œå¯¹torch.tensor()è®¾ç½®é»˜è®¤çš„tensorç±»å‹
>>> torch.tensor([1.2, 3]).dtype      # initial default for floating point is torch.float32
torch.float32
>>> torch.set_default_dtype(torch.float64)
>>> torch.tensor([1.2, 3]).dtype      # a new floating point tensor
torch.float64
>>> torch.set_default_tensor_type(torch.DoubleTensor)
>>> torch.tensor([1.2, 3]).dtype    	# a new floating point tensor
torch.float64

torch.get_default_dtype() 						# è·å¾—å½“å‰é»˜è®¤çš„æµ®ç‚¹ç±»å‹torch.dtype
torch.set_printoptions(precision=None, threshold=None, edgeitems=None, linewidth=None, profile=Noneï¼‰												# è®¾ç½®printingçš„æ‰“å°å‚æ•°
```





#### References

* [pytorchå…¥å‘ä¸€: TensoråŠå…¶åŸºæœ¬æ“ä½œ](https://zhuanlan.zhihu.com/p/36233589)
* [Pytorchä¸­.new()çš„ä½œç”¨è¯¦è§£](https://www.jb51.net/article/180679.htm)
* [æµ…è°ˆpytorchå’ŒNumpyçš„åŒºåˆ«ä»¥åŠç›¸äº’è½¬æ¢æ–¹æ³•](https://www.jb51.net/article/144520.htm)
* [**torch.eye**](https://www.cnblogs.com/btschang/p/10300727.html)
* [PyTorchçš„å­¦ä¹ ç¬”è®°](https://www.cnblogs.com/gato-chat/p/9064974.html)
* [pytorch.range() å’Œ pytorch.arange() çš„åŒºåˆ«](https://blog.csdn.net/m0_37586991/article/details/88830026)
* [PyTorchä¸­linspaceçš„è¯¦ç»†ç”¨æ³•](https://blog.csdn.net/york1996/article/details/81671128)
* [torch.normal()](https://blog.csdn.net/sxs11/article/details/81775715)
* [torch.randnå’Œtorch.randæœ‰ä»€ä¹ˆåŒºåˆ«](https://blog.csdn.net/wangwangstone/article/details/89815661)
* [randpermå‡½æ•°](https://www.cnblogs.com/ymjyqsx/p/6200692.html)
* [Pytorchä¸­index_select() å‡½æ•°çš„å®ç°ç†è§£](https://www.jb51.net/article/174524.htm)
* [torch.masked_select æ©ç ](https://blog.csdn.net/q511951451/article/details/81611903)
* [Pytorch mask_select å‡½æ•°](https://blog.csdn.net/SoftPoeter/article/details/81667810)
* [Pytorchä¸­çš„torch.cat()å‡½æ•°](https://www.cnblogs.com/JeasonIsCoding/p/10162356.html)
* [torch.stack()çš„ä½¿ç”¨](https://blog.csdn.net/Teeyohuang/article/details/80362756)
* [pytorchä¸­çš„catã€stackã€tranposeã€permuteã€unsqeeze](https://www.cnblogs.com/yifdu25/p/9399047.html)
* [pytorchä¹‹torch.gatheræ–¹æ³•](https://blog.csdn.net/edogawachia/article/details/80515038)
* [pytorchä¸­çš„gatherå‡½æ•°](https://blog.csdn.net/edogawachia/article/details/80515038)
* [torch.split() ä¸ torch.chunk()](https://www.codetd.com/article/8938026)
* [pytorchå­¦ä¹  ä¸­ torch.squeeze() å’Œtorch.unsqueeze()çš„ç”¨æ³•](https://blog.csdn.net/xiexu911/article/details/80820028)
* [torch.t()](https://blog.csdn.net/foneone/article/details/103876131)
* [Pytorché˜…è¯»æ–‡æ¡£ä¹‹reshapeï¼Œviewï¼Œflatten, transposeå‡½æ•°](https://blog.csdn.net/GhostintheCode/article/details/102531237)
* [Pytorch-Where](https://www.jianshu.com/p/439f0e48618e)
* [np.whereå’Œtorch.whereçš„ä½¿ç”¨åŒºåˆ«](https://blog.csdn.net/xijuezhu8128/article/details/86590562)
* [atan2](https://baike.baidu.com/item/atan2/10931300)
* [Pytorch TensoråŸºæœ¬æ•°å­¦è¿ç®—è¯¦è§£](https://www.jb51.net/article/177464.htm)
* [torch.Storage](https://blog.csdn.net/Mr_JP/article/details/81906616)
* [pytorch torch.Storageå­¦ä¹ ](https://www.cnblogs.com/wanghui-garcia/p/10623033.html)
