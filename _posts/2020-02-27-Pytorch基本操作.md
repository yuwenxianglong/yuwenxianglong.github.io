---
title: Pytorch基本操作
author: 赵旭山
tags: Pytorch
---

搜索网页学习Pytorch中看到一张结构清晰的思维导图，作者总结得很清晰，引用过来学习学习。如下：

Figure source: [https://zhuanlan.zhihu.com/p/36233589](https://zhuanlan.zhihu.com/p/36233589)

![](/assets/images/pytorchflowchart202002272158.jpg)

#### 1. Tensor属性

```python
x = torch.rand(5, 3)
x.dtype
x.device
x.layout
x.stride()
```

> torch.float32
>
> device(type='cpu')
>
> torch.strided
>
> (3, 1)

dtype就是数据的类型，Pytorch共有八种数据类型：

| Data type                | dtype                         | dtype                |
| ------------------------ | ----------------------------- | -------------------- |
| 32-bit floating point    | torch.float32 or torch.float  | torch.*.FloatTensor  |
| 64-bit floating point    | torch.float64 or torch.double | torch.*.DoubleTensor |
| 16-bit floating point    | torch.float16 or torch.half   | torch.*.HalfTensor   |
| 8-bit integer (unsigned) | torch.uint8                   | torch.*.ByteTensor   |
| 8-bit integer (signed)   | torch.int8                    | torch.*.CharTensor   |
| 16-bit integer (signed)  | torch.int16 or torch.short    | torch.*.ShortTensor  |
| 32-bit integer (signed)  | torch.int32 or torch.int      | torch.*.IntTensor    |
| 64-bit integer (signed)  | torch.int64 or torch.long     | torch.*.LongTensor   |

layout是数据在内存中是怎么存的，分为稀疏张量和致密张量，常用的为致密张量（`torch.strided`）。

```python
In [7]: x.stride()                                              
Out[7]: (3, 1)

In [8]: x                                                       
Out[8]: 
tensor([[0.6031, 0.0937, 0.3282],
        [0.2758, 0.8520, 0.1412],
        [0.9676, 0.9618, 0.5699],
        [0.1657, 0.2150, 0.9051],
        [0.7828, 0.9131, 0.4832]])

In [9]: x.stride()                                              
Out[9]: (3, 1)

In [10]: x.t()                                                  
Out[10]: 
tensor([[0.6031, 0.2758, 0.9676, 0.1657, 0.7828],
        [0.0937, 0.8520, 0.9618, 0.2150, 0.9131],
        [0.3282, 0.1412, 0.5699, 0.9051, 0.4832]])

In [11]: x.t().stride()                                         
Out[11]: (1, 3)
```

